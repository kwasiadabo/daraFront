(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[76],{1310:function(e,t,a){"use strict";a.r(t);var n=a(168),r=a(112),c=a(109),l=a.n(c),o=a(165),s=a(658),u=a(1),m=a.n(u),i=a(45),f=a.n(i),d=(a(661),a(164)),b=a(1308),p=a(111),O=a(660),j=a.n(O),y=a(83),h=a(687),v=a.n(h),E=a(697),x=a(751),C=a(814),g=a(673),N=u.forwardRef((function(e,t){var a=e.bsPrefix,n=e.className,c=e.variant,l=e.as,o=void 0===l?"img":l,s=Object(y.a)(e,["bsPrefix","className","variant","as"]),u=Object(E.a)(a,"card-img");return Object(g.jsx)(o,Object(r.a)({ref:t,className:v()(c?"".concat(u,"-").concat(c):u,n)},s))}));N.displayName="CardImg";var S=N,w=u.createContext(null);w.displayName="CardHeaderContext";var k=w,P=u.forwardRef((function(e,t){var a=e.bsPrefix,n=e.className,c=e.as,l=void 0===c?"div":c,o=Object(y.a)(e,["bsPrefix","className","as"]),s=Object(E.a)(a,"card-header"),m=Object(u.useMemo)((function(){return{cardHeaderBsPrefix:s}}),[s]);return Object(g.jsx)(k.Provider,{value:m,children:Object(g.jsx)(l,Object(r.a)(Object(r.a)({ref:t},o),{},{className:v()(n,s)}))})}));P.displayName="CardHeader";var U=P,B=Object(C.a)("h5"),R=Object(C.a)("h6"),T=Object(x.a)("card-body"),F=Object(x.a)("card-title",{Component:B}),D=Object(x.a)("card-subtitle",{Component:R}),I=Object(x.a)("card-link",{Component:"a"}),L=Object(x.a)("card-text",{Component:"p"}),A=Object(x.a)("card-footer"),H=Object(x.a)("card-img-overlay"),M=u.forwardRef((function(e,t){var a=e.bsPrefix,n=e.className,c=e.bg,l=e.text,o=e.border,s=e.body,u=e.children,m=e.as,i=void 0===m?"div":m,f=Object(y.a)(e,["bsPrefix","className","bg","text","border","body","children","as"]),d=Object(E.a)(a,"card");return Object(g.jsx)(i,Object(r.a)(Object(r.a)({ref:t},f),{},{className:v()(n,d,c&&"bg-".concat(c),l&&"text-".concat(l),o&&"border-".concat(o)),children:s?Object(g.jsx)(T,{children:u}):u}))}));M.displayName="Card",M.defaultProps={body:!1};var G=Object.assign(M,{Img:S,Title:F,Subtitle:D,Body:T,Link:I,Text:L,Header:U,Footer:A,ImgOverlay:H}),J=a(664),z=a(657);t.default=function(){var e,t=Object(u.useState)([]),a=Object(s.a)(t,2),c=a[0],i=a[1],O=Object(u.useState)(p.a.getCurrentUser()),y=Object(s.a)(O,2),h=y[0],v=(y[1],Object(u.useState)([])),E=Object(s.a)(v,2),x=(E[0],E[1],Object(u.useState)([])),C=Object(s.a)(x,2),g=C[0],N=C[1],S=Object(u.useState)(!1),w=Object(s.a)(S,2),k=w[0],P=w[1],U=Object(u.useState)(""),B=Object(s.a)(U,2),R=B[0],T=B[1],F=Object(u.useState)({amount:0,overage:0,shortage:0}),D=Object(s.a)(F,2),I=D[0],L=D[1],A=Object(u.useState)(new Date),H=Object(s.a)(A,2),M=(H[0],H[1],Object(u.useState)(0)),K=Object(s.a)(M,2),Y=K[0],q=K[1],Q=Object(u.useState)(1),V=Object(s.a)(Q,2),W=(V[0],V[1],Object(u.useState)(1)),X=Object(s.a)(W,2),Z=(X[0],X[1],Object(u.useState)("")),$=Object(s.a)(Z,2),_=$[0],ee=$[1],te=Object(u.useState)(!1),ae=Object(s.a)(te,2),ne=ae[0],re=ae[1],ce=Object(u.useState)(!1),le=Object(s.a)(ce,2),oe=le[0],se=le[1],ue=Object(u.useState)(!0),me=Object(s.a)(ue,2),ie=me[0],fe=me[1],de=Object(u.useState)([]),be=Object(s.a)(de,2),pe=(be[0],be[1],Object(u.useState)([])),Oe=Object(s.a)(pe,2),je=(Oe[0],Oe[1],Object(u.useState)(0)),ye=Object(s.a)(je,2),he=ye[0],ve=ye[1],Ee=Object(u.useState)({dateOfCollection:(new Date).toISOString().slice(0,10),officer:"",customer:"",amount:"",modeOfPayment:""}),xe=Object(s.a)(Ee,2),Ce=xe[0],ge=xe[1],Ne=Object(u.useState)((new Date).toISOString().slice(0,10)),Se=Object(s.a)(Ne,2),we=Se[0],ke=Se[1];Object(u.useEffect)((function(){(function(){var e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(d.apiUrl+"/loan/dailycollections/"+h.staff);case 2:t=e.sent,i(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c,oe]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get(d.apiUrl+"/loan/bulkCash/submitted/"+we+"/"+h.staff);case 3:t=e.sent,L(Object(r.a)(Object(r.a)({},I),{},{amount:t.data[0].TotalSubmitted})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[we,oe]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(d.apiUrl+"/loan/dailycollections/"+we+"/"+h.staff);case 2:t=e.sent,q(t.data[0].TotalDailyCollections);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[oe,we]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(d.apiUrl+"/loan/dailycollections/dayspayments/"+we+"/"+h.staff);case 2:t=e.sent,N(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[oe,we]);var Pe=new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}),Ue=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(d.apiUrl+"/loan/dailycollections/bal/"+t.id);case 2:a=e.sent,T(t.fullName),ve(a.data[0].loanBalance),ge({customer:t.id,dateOfCollection:we,officer:h.staff});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Be={customer:c.filter((function(e){return e.fullName.toLowerCase().includes(_.toLowerCase())}))},Re=0===_.length?c:Be.customer,Te=function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(I.amount-Y<Ce.amount)){e.next=2;break}return e.abrupt("return",j.a.fire("OOPS","Payment Unsuccessful - Insufficient Bulk Amount","error"));case 2:return e.prev=2,e.next=5,f.a.post(d.apiUrl+"/loan/dailycollections",Ce);case 5:if("OK"!==e.sent.statusText){e.next=12;break}j.a.fire("Success","Payment Made","success"),ge({customer:"",amount:"",modeOfPayment:"",officer:"",dateOfCollection:""}),se(!oe),e.next=13;break;case 12:return e.abrupt("return",j.a.fire("OOPS","Payment Unsuccessful","error"));case 13:e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(2),e.abrupt("return",j.a.fire("OOPS",e.t0+" [Payment Unsuccessful]","error"));case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.a.fire({title:"Do you want to remove this payment?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Remove",denyButtonText:"Don't Remove"}).then(function(){var e=Object(o.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isConfirmed){e.next=14;break}return e.prev=1,e.next=4,f.a.delete(d.apiUrl+"/loan/dailycollections/"+t.id);case 4:200===e.sent.status&&j.a.fire("Success","Payment Removed","success"),se(!oe),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),j.a.fire("Error",e.t0+" Payment Removal Failed","error");case 12:e.next=15;break;case 14:a.isDenied&&j.a.fire("Payment Removal Failed","","error");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()),se(!oe);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(Ce),e.prev=1,e.next=4,f.a.put(d.apiUrl+"/collectionsheet/"+Ce.id,Ce);case 4:if(200!==e.sent.status){e.next=11;break}j.a.fire("Success","Payment Updated","success"),ge({customer:"",fullName:"",amount:"",modeOfPayment:"",loanId:"",officer:"",comment:"",entryBy:"",dateOfCollection:""}),se(!oe),e.next=12;break;case 11:return e.abrupt("return",j.a.fire("OOPS","Payment Update Unsuccessful","error"));case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",j.a.fire("OOPS",e.t0+" [Payment Update Unsuccessful]","error"));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post(d.apiUrl+"/loan/dailycollections/"+h.staff+"/"+we);case 3:j.a.fire("Submission Done","Days Collections Submitted!","success"),se(!oe),Le(d.reportUrl+"/dailyEntry.aspx?"+h.staff+"?"+we),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",j.a.fire("OOPS",e.t0+" [Collections Submission Failed]","error"));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Le=function(e){window.open(e,"Daily Entry","popup","left=100,top=100,width=380,height=320")};return m.a.createElement("div",null,m.a.createElement("div",{className:"col-sm-12"},m.a.createElement("h3",{className:"centertext mt-"},"Customer Loan Repayment"),m.a.createElement(z.R,{type:"date",name:"dateToday",className:"form-control text-center col-sm-12",id:"dateToday",value:we,onChange:function(e){ke(e.currentTarget.value),console.log(I.amount+I.shortage-I.overage-Y)}}),m.a.createElement("div",{className:"row text-center col-sm-12 justify-content-center"},m.a.createElement("div",{classname:"m-3"},m.a.createElement(G,{style:{width:"12rem",height:"6rem"},className:"m-3"},m.a.createElement(G.Body,null,m.a.createElement(G.Title,null,"Submitted"),Pe.format(I.amount)))),m.a.createElement("div",{classname:"m-3"},m.a.createElement(G,{style:{width:"12rem",height:"6rem"},className:"m-3"},m.a.createElement(G.Body,null,m.a.createElement(G.Title,null,"Payments"),Pe.format(Y)))),m.a.createElement("div",{classname:"m-3 justify-content-right"},m.a.createElement(G,{style:{width:"12rem",height:"6rem"},className:parseFloat(I.amount-Y)>0?"positivebalcolor m-3":"negativebalcolor m-3"},m.a.createElement(G.Body,null,m.a.createElement(G.Title,null,parseFloat(I.amount-Y)<0?"Overage":"Balance"),Pe.format(parseFloat(I.amount-Y)))))),m.a.createElement(z.f,{className:"mt-3 mb-2 float-right",onClick:function(){if(I.amount<=0)return j.a.fire("OOPS","You have NOT submitted Bulk Cash for "+we,"error");fe(!0),re(!1),P(!0)},color:"success"},"Make Loan Payments"),m.a.createElement(J.c,{className:"table align-left mb-0 bg-white table-sm"},m.a.createElement("thead",null,m.a.createElement("tr",{className:"fs-sm"},m.a.createElement("th",null),m.a.createElement("th",null,"Customer"),m.a.createElement("th",null,"Mode"),m.a.createElement("th",null,"Amount"),m.a.createElement("th",null,"Status"),m.a.createElement("th",null))),m.a.createElement("tbody",null,g.map((function(e,t){return m.a.createElement("tr",{key:e.id},m.a.createElement("td",null,t+1),m.a.createElement("td",null,e.Customer),m.a.createElement("td",null,e.ModeOfPayment),m.a.createElement("td",null,Pe.format(e.Amount)),m.a.createElement("td",null,e.status),"Not Submitted"===e.status?m.a.createElement("td",null,m.a.createElement(z.f,{className:"btn-sm",color:"danger",onClick:function(){return Fe(e)}},"remove")):null)})))),m.a.createElement("div",{className:"d-flex mt-5 justify-content-center"},I.amount+I.shortage-I.overage-Y==0&&m.a.createElement(z.f,{className:"col-sm-3 float-center",color:"danger",onClick:Ie},"Submit Days Collections"))),m.a.createElement(b.a,{className:"modalCustomer fade ",size:"md",show:k,"data-backdrop":"static","data-keyboard":"false"},m.a.createElement(b.a.Body,{className:"modal-body col-sm-12"},m.a.createElement("div",{className:"float-center mb-2"},m.a.createElement(z.R,{className:"col-sm-12 mb-2 text-center",placeholder:" Search Loan Customer",onChange:function(e){ee(e.currentTarget.value)}})),m.a.createElement(J.c,{className:"table mb-3 mt-2 align-middle mb-0 bg-white table-sm"},m.a.createElement("thead",null,m.a.createElement("tr",{className:"fs-sm"},m.a.createElement("th",null,"A/C No."),m.a.createElement("th",null,"Name"),m.a.createElement("th",null))),m.a.createElement("tbody",null,Re.map((function(e,t){return m.a.createElement("tr",{key:e.id,onClick:function(){return Ue(e)}},m.a.createElement("td",null,e.accountNumber),m.a.createElement("td",null,e.fullName),m.a.createElement("td",null,m.a.createElement(z.f,{color:"danger",onClick:function(){return Ue(e)},className:"btn-sm"},"Select")))})))),m.a.createElement("form",null,m.a.createElement("label",{htmlFor:"nameOfOfficer",className:"form-label"},"Name of Customer"),m.a.createElement(z.R,{name:"nameOfCustomer",className:"text-center",type:"text",id:"nameOfCustomer",value:R,autoComplete:"off",readOnly:!0}),m.a.createElement("label",{htmlFor:"Balance",className:"form-label"},"Current Loan Balance"),m.a.createElement(z.R,{name:"Balance",className:"form-control  text-center",type:"text",id:"Balance",value:Pe.format(he),autoComplete:"off",readOnly:!0}),m.a.createElement(z.wb,{className:"form-select  mb-3 mt-4 text-center","aria-label":".form-select-lg",value:Ce.modeOfPayment,onChange:function(e){return ge(Object(r.a)(Object(r.a)({},Ce),{},{modeOfPayment:e.currentTarget.value}))}},m.a.createElement("option",{value:""},"Select Mode of Payment"),m.a.createElement("option",{value:"Cash"},"Cash")),m.a.createElement("label",{htmlFor:"amountReceived",className:"form-label"},"Amount (GHS)"),m.a.createElement(z.R,{autoComplete:"off",type:"text",name:"amountReceived",className:"form-control  text-right",id:"amountReceived",value:Ce.amount,onChange:function(e){ge(Object(r.a)(Object(r.a)({},Ce),{},{amount:e.currentTarget.value,officer:h.staff}))}}),m.a.createElement("label",{htmlFor:"comment",className:"form-label"},"Comment"),m.a.createElement(z.R,(e={autoComplete:"off",type:"textArea",name:"comment",className:"form-control text-center",id:"comment",value:null},Object(n.a)(e,"autoComplete","off"),Object(n.a)(e,"onChange",(function(e){return ge(Object(r.a)({},Ce))})),e)))),m.a.createElement(b.a.Footer,null,ie&&m.a.createElement(z.f,{onClick:Te,color:"success"},"Submit"),ne&&m.a.createElement(z.f,{onClick:De,color:"info"},"Update"),m.a.createElement(z.f,{onClick:function(){ge({customer:"",amount:"",modeOfPayment:"",officer:"",dateOfCollection:""}),T(""),P(!1)},color:"danger"},"Close"))))}}}]);
//# sourceMappingURL=76.878a86b8.chunk.js.map