(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[70],{1294:function(e,t,a){"use strict";a.r(t);var n=a(112),r=a(109),c=a.n(r),l=a(164),u=a(654),s=a(1),o=a.n(s),m=a(45),i=a.n(m),b=a(657),d=a.n(b),f=a(658),h=a.n(f),p=(a(665),a(656)),E=a.n(p),v=a(111),O=a(163),N=a(667),k=a(659),C=a(653);t.default=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),a=t[0],r=t[1],m=Object(s.useState)(""),b=Object(u.a)(m,2),f=b[0],p=b[1],q=Object(s.useState)(!1),g=Object(u.a)(q,2),y=g[0],j=g[1],w=Object(s.useState)([]),D=Object(u.a)(w,2),S=D[0],x=D[1],B=Object(s.useState)(""),Y=Object(u.a)(B,2),A=Y[0],M=Y[1],T=Object(s.useState)([]),F=Object(u.a)(T,2),U=F[0],I=F[1],H=Object(s.useState)(""),R=Object(u.a)(H,2),G=(R[0],R[1],Object(s.useState)([])),L=Object(u.a)(G,2),V=L[0],P=L[1],J=Object(s.useState)([]),z=Object(u.a)(J,2),Q=z[0],K=z[1],W=Object(s.useState)([]),X=Object(u.a)(W,2),Z=X[0],$=X[1],_=Object(s.useState)({nameOnCheque:"",bank:0,bankAccount:0,dateOnCheque:"",chequeNumber:"",amount:"",issuedBy:0,status:"Not Disbursed",bookingStatus:"Not Booked",entryDate:new Date}),ee=Object(u.a)(_,2),te=ee[0],ae=ee[1],ne=Object(s.useState)((new Date).toISOString().slice(0,10)),re=Object(u.a)(ne,2),ce=re[0],le=re[1],ue=Object(s.useState)((new Date).toISOString().slice(0,10)),se=Object(u.a)(ue,2),oe=se[0],me=se[1],ie=v.a.getCurrentUser(),be=new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"});Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(O.apiUrl+"/customer");case 2:t=e.sent,x(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[S]),Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(O.apiUrl+"/setup/bank");case 2:t=e.sent,P(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var de=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(O.apiUrl+"/setup/bankaccount/"+t);case 2:a=e.sent,K(a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(O.apiUrl+"/loan/issuedloancheques/"+ce+"/"+oe);case 2:t=e.sent,$(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[ce,oe,y]),Object(s.useEffect)((function(){function e(){return(e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(O.apiUrl+"/loan/issuedloancheques/"+ce+"/"+oe);case 2:t=e.sent,I(t.data),console.log(t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),console.log(U)}),[y]);var fe={nameOnCheque:h.a.number().required().label("Name on Cheque"),bank:h.a.number().required().label("Bank"),bankAccount:h.a.number().required().label("Bank Account"),dateOnCheque:h.a.date().required().label("Date On Cheque"),chequeNumber:h.a.string().required().label("Cheque Number"),amount:h.a.string().required().label("Amount"),issuedBy:h.a.number().required(),entryDate:h.a.date().required(),status:h.a.string(),bookingStatus:h.a.any()},he=h.a.object(fe),pe=function(){var e=h.a.validate(te,he);return e.error?e.error.details[0].message:null},Ee=function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===f){e.next=2;break}return e.abrupt("return",E.a.fire("OOPS!","Active Loan Detected - Customer is servicing an active loan","error"));case 2:if(null===(t=pe())){e.next=5;break}return e.abrupt("return",E.a.fire("Validation",t,"error"));case 5:return e.prev=5,e.next=8,i.a.post(O.apiUrl+"/loan/issuedloancheques",te);case 8:if(200===e.sent.status){e.next=13;break}return e.abrupt("return",E.a.fire("OOPs !","Submission Failed ! Check Entries and try again !","error"));case 13:E.a.fire("Good job!","Cheque Details Saved Successfully","success"),j(!y),ae({nameOnCheque:"",bank:0,bankAccount:"",dateOnCheque:"",chequeNumber:"",amount:"",issuedBy:0,status:"Not Disbursed",bookingStatus:"Not Booked",entryDate:new Date});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),E.a.fire("OOPS ! "+e.t0.message,"error");case 21:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(){return e.apply(this,arguments)}}(),ve=(new Intl.NumberFormat("de-CH",{style:"currency",currency:"CHF"}),S.map((function(e){return{label:e.fullName+" - "+e.accountNumber,value:e.id}}))),Oe=function(){var e=Object(l.a)(c.a.mark((function e(t){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.value,ae(Object(n.a)(Object(n.a)({},te),{},{nameOnCheque:a})),e.next=4,i.a.get(O.apiUrl+"/loan/issuedloancheques/checkactiveloan/"+a);case 4:r=e.sent,p(r.data.length);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=new Date;Ne.toLocaleString("default",{month:"long"}),Ne.getDate(),Ne.getFullYear();var ke=Z.reduce((function(e,t){return e+t.amount}),0),Ce=function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(t.currentTarget.value);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe={scheques:Z.filter((function(e){return e.chequeNumber.includes(A)}))},ge=0===A.length?Z:qe.scheques;return o.a.createElement("div",{className:"container-fluid"},o.a.createElement("div",{className:"row justify-content-center"},o.a.createElement("h4",{className:"centertext mb-2"},"Loan Cheques Issuance")),o.a.createElement("p",{className:"centertext m-2 p"},"Issuing cheque means you are paying to someone. That's why your bank should be credited as it reduces your bank balance."),o.a.createElement("div",{className:"mb-3"},o.a.createElement("div",{class:"mb-3 row mt-5 col-sm-12"},o.a.createElement(C.bb,{htmlFor:"dateOnCheque",className:"form-label"},"Start Date"),o.a.createElement("div",{className:"col-sm-3"},o.a.createElement(C.R,{type:"date",class:"form-control",id:"dateOnCheque",value:ce,onChange:function(e){le(e.currentTarget.value)}})),o.a.createElement(C.bb,{htmlFor:"dateOnCheque",className:"form-label"},"End Date"),o.a.createElement("div",{className:"col-sm-3"},o.a.createElement(C.R,{type:"date",class:"form-control",id:"dateOnCheque",value:oe,onChange:function(e){me(e.currentTarget.value)}})),o.a.createElement(C.bb,{htmlFor:"chequeNumber",className:"form-label"},"Cheque Number"),o.a.createElement("div",{className:"col-sm-3"},o.a.createElement(C.R,{type:"text",class:"form-control",id:"chequeNumber",value:A,onChange:Ce})),o.a.createElement(C.cb,{className:"btn-block col-sm-3 float-left btn-sm mb-3 mt-3",onClick:function(){return e=O.reportUrl+"/issuedLoanCheques.aspx?"+ce+"?"+oe,void window.open(e,"customerlist","popup","left=100,top=100,width=320,height=320");var e}},"View as Report")),o.a.createElement(C.f,{color:"success",className:"btn-sm float-right mb-3",onClick:function(){return r(!a)},title:"Make New Entry"},"+ Issue Cheque"),o.a.createElement("div",{className:"sm mt-3"},"Number of Cheques :","  ",o.a.createElement("strong",null," ",Z.length)),o.a.createElement("div",{className:"sm mt-3"},"Total of Amount (GHS) :","  ",o.a.createElement("strong",null,be.format(ke))),o.a.createElement(k.c,{className:"table-lg"},o.a.createElement("caption",null,"Issued Cheques: ",d()(ce).format("DD-MMMM-YYYY")," -"," ",d()(oe).format("DD-MMMM-YYYY")),o.a.createElement("thead",null,o.a.createElement("tr",{className:"fs-sm"},o.a.createElement("th",null),o.a.createElement("th",null,"Name on Cheque"),o.a.createElement("th",null,"Bank"),o.a.createElement("th",null,"Bank Account"),o.a.createElement("th",null,"Date on Cheque"),o.a.createElement("th",null,"Cheque No."),o.a.createElement("th",null,"Amount (GHC)"),o.a.createElement("th",null,"Issued By"),o.a.createElement("th",null,"Date Issued"),o.a.createElement("th",null))),o.a.createElement("tbody",null,ge.map((function(e,t){return o.a.createElement("tr",{key:e.id},o.a.createElement("td",null,t+1),o.a.createElement("td",null,e.nameOnCheque),o.a.createElement("td",null,e.bank),o.a.createElement("td",null,e.accountNumber),o.a.createElement("td",null,d()(e.dateOnCheque).format("DD-MMMM-YYYY")),o.a.createElement("td",null,e.chequeNumber),o.a.createElement("td",null,be.format(e.amount)),o.a.createElement("td",null,e.issuedBy),o.a.createElement("td",null,d()(e.entryDate).format("DD-MMMM-YYYY")),o.a.createElement("td",null,"Not Disbursed"===e.status&&o.a.createElement(C.f,{color:"danger",className:"btn-sm",onClick:function(){return function(e){E.a.fire({title:"Do you want to delete this issued Cheque?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(function(){var t=Object(l.a)(c.a.mark((function t(a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a.isConfirmed){t.next=7;break}return t.next=3,i.a.delete(O.apiUrl+"/loan/issuedloancheques/"+e.id);case 3:E.a.fire("Deletion Confirmed !","","success"),j(!y),t.next=8;break;case 7:a.isDenied&&E.a.fire("Deletion NOT Confirmed","","info");case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}(e)},title:"Cheques Issued Entry"},"Delete")))}))))),o.a.createElement(C.fb,{className:"modal fade col-sm-10",size:"lg",show:a,color:"success","data-backdrop":"static","data-keyboard":"false",onClose:function(){r(!a)}},o.a.createElement(C.ib,{className:"modal-header",closeButton:!0},o.a.createElement("p",null,o.a.createElement("h3",{className:"centertext"},"ISSUE LOAN CHEQUE"))),o.a.createElement(C.gb,{className:"modal-body col-sm-12"},o.a.createElement("div",{class:"mb-3 row"},o.a.createElement(C.bb,{htmlFor:"nameOfCustomer",className:"col-sm-3 col-form-label"},"Name of Customer"),o.a.createElement("div",{class:"col-sm-8"},o.a.createElement(N.a,{className:"form-control-xl mb-2 mt-2",options:ve,onChange:Oe}))),o.a.createElement("div",{class:"mb-3 row"},o.a.createElement(C.bb,{htmlFor:"bank",className:"col-sm-3 col-form-label"},"Bank"),o.a.createElement("div",{class:"col-sm-8"},o.a.createElement(C.wb,{id:"bank",className:"form-select","aria-label":"Default select example",value:te.bank,onChange:function(e){de(e.currentTarget.value),ae(Object(n.a)(Object(n.a)({},te),{},{bank:e.currentTarget.value}))}},o.a.createElement("option",{defaultValue:""},"--Select Bank--"),V.map((function(e){return o.a.createElement("option",{key:e.id,value:e.id,id:e.id},e.bank)}))))),o.a.createElement("div",{class:"mb-3 row"},o.a.createElement(C.bb,{for:"bankAccount",class:"col-sm-3 col-form-label"},"Bank Account"),o.a.createElement("div",{class:"col-sm-8"},o.a.createElement(C.wb,{id:"bankAccount",className:"form-select","aria-label":"Default select example",value:te.bankAccount,onChange:function(e){return ae(Object(n.a)(Object(n.a)({},te),{},{bankAccount:e.currentTarget.value,issuedBy:ie.id}))}},o.a.createElement("option",{defaultValue:""},"--Select Bank Account--"),Q.map((function(e){return o.a.createElement("option",{key:e.id,value:e.id,id:e.id},e.accountNumber)}))))),o.a.createElement("div",{class:"mb-3 row"},o.a.createElement(C.bb,{htmlFor:"dateOnCheque",className:"col-sm-3 col-form-label"},"Date on Cheque"),o.a.createElement("div",{className:"col-sm-8"},o.a.createElement(C.R,{type:"date",class:"form-control",id:"dateOnCheque",value:te.dateOnCheque,onChange:function(e){return ae(Object(n.a)(Object(n.a)({},te),{},{dateOnCheque:e.currentTarget.value}))}}))),o.a.createElement("div",{className:"mb-3 row"},o.a.createElement(C.bb,{htmlFor:"chequeNumber",className:"col-sm-3 col-form-label"},"Cheque No."),o.a.createElement("div",{className:"col-sm-8"},o.a.createElement(C.R,{type:"text",className:"form-control",id:"chequeNumber",value:te.chequeNumber,onChange:function(e){return ae(Object(n.a)(Object(n.a)({},te),{},{chequeNumber:e.currentTarget.value}))}}))),o.a.createElement("div",{class:"mb-3 row"},o.a.createElement(C.bb,{htmlFor:"amount",className:"col-sm-3"},"Amount (GHS)"),o.a.createElement("div",{class:"col-sm-8"},o.a.createElement(C.R,{id:"amount",className:"form-control",type:"text",value:te.amount,onChange:function(e){return ae(Object(n.a)(Object(n.a)({},te),{},{amount:e.currentTarget.value}))}})))),o.a.createElement(C.hb,null,o.a.createElement("div",{className:"justify-content-center"},o.a.createElement(C.f,{onClick:Ee,className:"m-3",color:"success"},"Submit"),o.a.createElement(C.f,{onClick:function(){return r(!a)},className:"m-3",color:"danger"},"Close")))))}}}]);
//# sourceMappingURL=70.1e295fdd.chunk.js.map