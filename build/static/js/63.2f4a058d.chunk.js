(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[63],{1299:function(e,a,t){"use strict";t.r(a);var r=t(112),n=t(109),l=t.n(n),c=t(164),o=t(654),m=t(1),s=t.n(m),u=t(19),i=t(45),f=t.n(i),b=(t(657),t(1305)),d=t(111),h=t(658),E=t.n(h),p=t(656),O=t.n(p),N=t(163),j=t(659),C=t(653);a.default=function(){var e=Object(m.useState)(d.a.getCurrentUser),a=Object(o.a)(e,2),t=a[0],n=(a[1],Object(m.useState)([])),i=Object(o.a)(n,2),h=i[0],p=i[1],w=Object(m.useState)(""),y=Object(o.a)(w,2),v=y[0],g=y[1],x=Object(m.useState)(!1),S=Object(o.a)(x,2),k=S[0],A=S[1],B=Object(m.useState)(!1),F=Object(o.a)(B,2),T=F[0],R=F[1],W=Object(m.useState)(!1),I=Object(o.a)(W,2),P=I[0],z=I[1],U=Object(m.useState)(0),D=Object(o.a)(U,2),H=(D[0],D[1],Object(m.useState)(0)),q=Object(o.a)(H,2),G=(q[0],q[1],Object(m.useState)("")),J=Object(o.a)(G,2),L=J[0],V=J[1],K=Object(m.useState)(0),M=Object(o.a)(K,2),Q=M[0],X=M[1],Y=Object(m.useState)(0),Z=Object(o.a)(Y,2),$=Z[0],_=(Z[1],Object(m.useState)({customer:0,amount:0,narration:"",entryBy:t.staff})),ee=Object(o.a)(_,2),ae=ee[0],te=ee[1],re=Object(m.useState)(5),ne=Object(o.a)(re,2),le=(ne[0],ne[1],Object(m.useState)(1)),ce=Object(o.a)(le,2),oe=(ce[0],ce[1],Object(u.g)());Object(m.useEffect)((function(){function e(){return(e=Object(c.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(N.apiUrl+"/loan/cashcollateral/withbal");case 2:a=e.sent,p(a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[P]);var me={scustomers:h.filter((function(e){return e.fullName.toLowerCase().includes(L.toLowerCase())}))},se=0===L.length?h:me.scustomers,ue={customer:E.a.number().required().label("Customer"),entryBy:E.a.number(),narration:E.a.string().required().label("Narration"),amount:E.a.number().allow("").label("Withdrawal Amount")},ie=E.a.object(ue),fe=function(){var e=E.a.validate(ae,ie);return e.error?e.error.details[0].message:null},be=function(){var e=Object(c.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=fe())){e.next=3;break}return e.abrupt("return",O.a.fire("OOPS",a,"error"));case 3:if(!($>0)){e.next=5;break}return e.abrupt("return",O.a.fire("Withdrawal Failure","Customer has not completed loan Payment. Withdrawal NOT Possible","warning"));case 5:if(!(ae.amount>Q)){e.next=7;break}return e.abrupt("return",O.a.fire("Withdrawal Failure","Insufficient Collateral Balance","warning"));case 7:if(ae.amount>0){e.next=9;break}return e.abrupt("return",O.a.fire("Withdrawal Failure","Invalid Withdrawal Amount","warning"));case 9:return e.next=11,f.a.post(N.apiUrl+"/loan/cashcollateral/withdrawal",ae);case 11:200===e.sent.status&&(O.a.fire("Success","Collateral withdrawal Successful, Pending Authorisation","success"),te({customer:0,amount:0,entryBy:t.staff,narration:""}),z(!P),A(!k));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(c.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=fe())){e.next=3;break}return e.abrupt("return",O.a.fire("OOPS",a,"error"));case 3:if(!(ae.amount>Q)){e.next=5;break}return e.abrupt("return",O.a.fire("Transfer Failure","Insufficient Collateral Balance","warning"));case 5:if(ae.amount>0){e.next=7;break}return e.abrupt("return",O.a.fire("Tranfer Failure","Invalid Tranfer Amount","warning"));case 7:return e.next=9,f.a.post(N.apiUrl+"/loan/cashcollateral/tranfer",{customer:ae.customer,Dr:ae.amount,narration:ae.narration,entryBy:t.staff});case 9:200===e.sent.status&&(O.a.fire("Success","Collateral Tranfer Successful, Pending Authorisation","success"),te({customer:0,amount:0,entryBy:t.staff,narration:""}),z(!P),R(!T));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}),Ee=function(e){te(Object(r.a)(Object(r.a)({},ae),{},{amount:e.currentTarget.value}))},pe=function(){te({customer:0,amount:0,entryBy:t.staff,narration:""}),A(!1),R(!1)};return s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-sm-12 mt-2"},s.a.createElement("div",{className:"row justify-content-center"},s.a.createElement("h4",{className:"centertext mb-3"},"Cash Collateral Activities")),s.a.createElement(C.R,{type:"text",name:"searchCustomer",className:"float-right col-sm-4 mb-3 mt-3",id:"searchCustomer",value:null,onChange:function(e){V(e.target.value)},placeholder:"Search Customer"}),s.a.createElement("p",{className:"text-left"},"NB: The list shows only customers with collateral balances greater than zero. i.e If customer does not have any balance, the details will not be shown below."),s.a.createElement(j.c,{className:"table-sm col-sm-12"},s.a.createElement("thead",{className:""},s.a.createElement("tr",{className:"fs-sm"},s.a.createElement("th",null),s.a.createElement("th",null,"ID"),s.a.createElement("th",null,"Name"),s.a.createElement("th",null,"Phone Number"),s.a.createElement("th",null,"Gender"),s.a.createElement("th",null,"Officer"),s.a.createElement("th",null,"Current Balance."),s.a.createElement("th",null))),s.a.createElement("tbody",null,se.map((function(e,a){return s.a.createElement("tr",{key:e.id},s.a.createElement("td",null,a+1),s.a.createElement("td",null,e.idNumber),s.a.createElement("td",null,e.fullName),s.a.createElement("td",null,e.phone),s.a.createElement("td",null,e.gender),s.a.createElement("td",null,e.nameOfStaff),s.a.createElement("td",null,he.format(e.Bal)),s.a.createElement("td",null,s.a.createElement(C.z,{className:"m-1"},s.a.createElement(C.E,{color:"success",size:"sm"},"Actions"),s.a.createElement(C.D,{size:"sm"},s.a.createElement(C.A,null),s.a.createElement(C.C,{onClick:function(){return function(e){g(e.fullName),X(e.Bal),te(Object(r.a)(Object(r.a)({},ae),{},{customer:e.id})),A(!k)}(e)}},"Withdrawal"),s.a.createElement(C.A,null),s.a.createElement(C.C,{onClick:function(){return function(e){g(e.fullName),X(e.Bal),te(Object(r.a)(Object(r.a)({},ae),{},{customer:e.id})),R(!T)}(e)}},"Transfer"),s.a.createElement(C.A,null)))))}))))),s.a.createElement(C.f,{onClick:function(){return oe.push("/loan/viewcollateralwithdrawals")},className:"btn-sm float-left mt-3",color:"info"},"View Withdrawals and Transfers")),s.a.createElement(b.a,{className:"fade col-sm-10",size:"md",show:k,"data-backdrop":"static","data-keyboard":"false"},s.a.createElement(b.a.Header,{className:"modal-header"},s.a.createElement("p",null,s.a.createElement("h3",null,"Collateral Withdrawal"))),s.a.createElement(b.a.Body,{className:"modal-body"},s.a.createElement("form",null,s.a.createElement("label",{htmlFor:"dateOfCollection",className:"form-label"},"Customer Name"),s.a.createElement(C.R,{type:"text",name:"customer",className:"form-control text-center col-sm-12 mb-3",id:"customer",value:v,readOnly:!0}),s.a.createElement("label",{htmlFor:"balance",className:"form-label"},"Collateral Balance"),s.a.createElement(C.R,{type:"text",name:"balance",className:"form-control text-right col-sm-12 mb-3",id:"balance",value:he.format(Q),readOnly:!0}),s.a.createElement("label",{htmlFor:"depositAmount",className:"form-label"},"Amount *"),s.a.createElement(C.R,{autoComplete:"off",type:"text",name:"depositAmount",className:"form-control col-sm-12 mb-3",id:"depositAmount",value:ae.amount,onChange:Ee}),s.a.createElement("label",{htmlFor:"comment",className:"form-label"},"Comment"),s.a.createElement(C.R,{autoComplete:"off",type:"text",name:"comment",className:"form-control  col-sm-12 mb-3",id:"comment",value:ae.narration,onChange:function(e){return te(Object(r.a)(Object(r.a)({},ae),{},{narration:e.currentTarget.value}))}}))),s.a.createElement(b.a.Footer,null,s.a.createElement(C.f,{onClick:be,className:"btn-sm",color:"success"},"Submit"),s.a.createElement(j.a,{onClick:pe,className:"btn-sm",color:"danger"},"Close"))),s.a.createElement(b.a,{className:"fade col-sm-10",size:"md",show:T,"data-backdrop":"static","data-keyboard":"false"},s.a.createElement(b.a.Header,{className:"modal-header"},s.a.createElement("p",null,s.a.createElement("h3",null,"Collateral Transfer"))),s.a.createElement(b.a.Body,{className:"modal-body"},s.a.createElement("form",null,s.a.createElement("label",{htmlFor:"dateOfCollection",className:"form-label"},"Customer Name"),s.a.createElement(C.R,{type:"text",name:"customer",className:"form-control text-center col-sm-12 mb-3",id:"customer",value:v,readOnly:!0}),s.a.createElement("label",{htmlFor:"balance",className:"form-label"},"Collateral Balance"),s.a.createElement(C.R,{type:"text",name:"balance",className:"form-control text-right col-sm-12 mb-3",id:"balance",value:he.format(Q),readOnly:!0}),s.a.createElement("label",{htmlFor:"depositAmount",className:"form-label"},"Tranfer Amount *"),s.a.createElement(C.R,{autoComplete:"off",type:"text",name:"depositAmount",className:"form-control col-sm-12 mb-3",id:"depositAmount",value:ae.amount,onChange:Ee}),s.a.createElement("label",{htmlFor:"comment",className:"form-label"},"Comment"),s.a.createElement(C.R,{autoComplete:"off",type:"text",name:"comment",className:"form-control  col-sm-12 mb-3",id:"comment",value:ae.narration,onChange:function(e){return te(Object(r.a)(Object(r.a)({},ae),{},{narration:e.currentTarget.value}))}}))),s.a.createElement(b.a.Footer,null,s.a.createElement(C.f,{onClick:de,className:"btn-sm",color:"success"},"Submit"),s.a.createElement(j.a,{onClick:pe,className:"btn-sm",color:"danger"},"Close"))))}}}]);
//# sourceMappingURL=63.2f4a058d.chunk.js.map