{"ast":null,"code":"import _objectSpread from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import Joi from'joi-browser';import moment from'moment';import momentBusinessDays from'moment-business-days';import baseUrl from'../../config.json';import auth from'../../components/services/authService';import Swal from'sweetalert2';import{Row,Col,Table,Progress,Button,UncontrolledButtonDropdown,DropdownMenu,DropdownToggle,DropdownItem,Input,Label,Badge}from'reactstrap';import{CBadge,CCard,CCardBody//CCardHeader,\n,CCol,CDataTable,CRow,CButton,CModal,CModalFooter,CModalHeader,CModalBody,CCardHeader,CInputGroupAppend,CInputGroupPrepend,CDropdownItem,CForm//CCardFooter,\n,CDropdownToggle//CInputRadio,\n,CDropdown,CModalTitle//CFormText,\n//CTextarea,\n,CFormGroup,CLabel// CSwitch,\n,CInput//CInputFile,\n,CSelect,CDropdownMenu//CCardFooter,\n,CInputGroup//CForm,\n}from'@coreui/react';var HolidaySetup=function HolidaySetup(){var _useState=useState({holiday:'',hdate:'',year:''}),_useState2=_slicedToArray(_useState,2),holiday=_useState2[0],setHoliday=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),holidays=_useState4[0],setHolidays=_useState4[1];var _useState5=useState(new Date().getFullYear()),_useState6=_slicedToArray(_useState5,2),currentYear=_useState6[0],setCurrentYear=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),editMode=_useState8[0],setEditMode=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),render=_useState10[0],setRender=_useState10[1];useEffect(function(){function getHolidays(){return _getHolidays.apply(this,arguments);}function _getHolidays(){_getHolidays=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var yearInt,results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:yearInt=new Date();_context.next=3;return axios.get(baseUrl.apiUrl+'/setup/holiday/'+currentYear);case 3:results=_context.sent;setHolidays(results.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return _getHolidays.apply(this,arguments);}getHolidays();},[currentYear,render]);var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),disableButton=_useState12[0],setDisableButton=_useState12[1];var joiHolidaySchema=Joi.object().keys({holiday:Joi.string().required().label('Holiday'),hdate:Joi.date().required().label('date'),year:Joi.number().required().label('Holiday Year')});var validateEntry=function validateEntry(){var result=Joi.validate(holidays,joiHolidaySchema);if(result.error){return result.error.details[0].message;}else{return null;}};var handleDateChange=function handleDateChange(e){var year=new Date(e.currentTarget.value);setHoliday(_objectSpread(_objectSpread({},holiday),{},{hdate:e.currentTarget.value,year:year.getFullYear()}));};var handleOnEdit=function handleOnEdit(p){console.log(p);setEditMode(true);setHoliday({id:p.id,holiday:p.holiday,hdate:new Date(p.hdate).toISOString().slice(0,10),year:p.year});//setDisabled(!disabled);\n};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var results;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// console.log(holiday)\nvalidateEntry();_context2.prev=1;_context2.next=4;return axios.post(baseUrl.apiUrl+'/setup/holiday',holiday);case 4:results=_context2.sent;if(results.status===200){Swal.fire('Success','Holiday Saved','success');setRender(!render);}else{Swal.fire('OOPS !','Saving Holiday, failed !','error');}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);Swal.fire(_context2.t0+' Saving Holiday, failed !','error');case 11:setHoliday({holiday:'',hdate:''});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var results;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(holiday);if(!(holiday.holiday!=='')){_context3.next=22;break;}_context3.prev=2;_context3.next=5;return axios.put(baseUrl.apiUrl+'/setup/holiday',holiday);case 5:results=_context3.sent;if(!(results.status!==200)){_context3.next=10;break;}return _context3.abrupt(\"return\",Swal.fire('OOPS !','Submission Failed ! Check Entries and try again !','error'));case 10:Swal.fire('Success','Holiday Updated Successfully','success');setHoliday({holiday:'',hdate:'',year:''});setRender(!render);setEditMode(false);setRender(!render);case 15:_context3.next=20;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](2);Swal.fire('OOPS ! '+_context3.t0.message,'error');case 20:_context3.next=23;break;case 22:return _context3.abrupt(\"return\",Swal.fire('OOPS','Enter all Details !','error'));case 23:case\"end\":return _context3.stop();}}},_callee3,null,[[2,17]]);}));return function handleUpdate(_x){return _ref2.apply(this,arguments);};}();var handleDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var results;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(holiday.holiday!=='')){_context4.next=21;break;}_context4.prev=1;_context4.next=4;return axios.delete(baseUrl.apiUrl+'/setup/holiday/'+holiday.id);case 4:results=_context4.sent;if(!(results.status!==200)){_context4.next=9;break;}return _context4.abrupt(\"return\",Swal.fire('OOPS !','Submission Failed ! Check Entries and try again !','error'));case 9:Swal.fire('Success','Holiday Deleted Successfully','success');setHoliday({holiday:'',hdate:'',year:''});setRender(!render);setEditMode(false);setRender(!render);case 14:_context4.next=19;break;case 16:_context4.prev=16;_context4.t0=_context4[\"catch\"](1);Swal.fire('OOPS ! '+_context4.t0.message,'error');case 19:_context4.next=22;break;case 21:return _context4.abrupt(\"return\",Swal.fire('OOPS','Select Holiday !','error'));case 22:case\"end\":return _context4.stop();}}},_callee4,null,[[1,16]]);}));return function handleDelete(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"centertext m-3\"},\"Set up Holidays\"),/*#__PURE__*/React.createElement(\"p\",{className:\"centertext m-3\"},\"Set up public holidays here. NB: Holidays are to be setup every year.\"),/*#__PURE__*/React.createElement(CInputGroup,{className:\"mt-3\"},/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"dailysales\",className:\"col-sm-2\"},\"Year\"),/*#__PURE__*/React.createElement(CSelect,{className:\"form-select col-sm-8 mb-3\",\"aria-label\":\"Default\",value:currentYear,onChange:function onChange(e){return setCurrentYear(e.currentTarget.value);}},/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()-4},new Date().getFullYear()-4),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()-3},new Date().getFullYear()-3),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()-2},new Date().getFullYear()-2),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()-1},new Date().getFullYear()-1),/*#__PURE__*/React.createElement(\"option\",{defaultValue:new Date().getFullYear()},new Date().getFullYear()),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()+1},new Date().getFullYear()+1),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()+2},new Date().getFullYear()+2),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()+3},new Date().getFullYear()+3),/*#__PURE__*/React.createElement(\"option\",{value:new Date().getFullYear()+4},new Date().getFullYear()+4))),/*#__PURE__*/React.createElement(CInputGroup,{className:\"mt-3\"},/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"holiday\",className:\"col-sm-2\"},\"Holiday\"),/*#__PURE__*/React.createElement(CInput,{autoComplete:\"off\",name:\"holiday\",type:\"text\",className:\"form-control col-sm-8\",value:holiday.holiday,onChange:function onChange(e){return setHoliday(_objectSpread(_objectSpread({},holiday),{},{holiday:e.currentTarget.value}));}})),/*#__PURE__*/React.createElement(CInputGroup,{className:\"mt-3\"},/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"dailysales\",className:\"col-sm-2\"},\"Holiday Date\"),/*#__PURE__*/React.createElement(CInput,{name:\"hdate\",type:\"date\",className:\"form-control col-sm-8\",value:holiday.hdate,onChange:handleDateChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center\"},!editMode?/*#__PURE__*/React.createElement(CButton,{className:\"btn btn-primary col-sm-2 mt-3 btn-sm\",onClick:handleSubmit},\"Submit\"):null,editMode?/*#__PURE__*/React.createElement(CButton,{className:\"btn-sm m-3 col-sm-2\",color:\"success\",onClick:handleUpdate},\"Update\"):null,editMode&&/*#__PURE__*/React.createElement(CButton,{className:\"btn btn-danger col-sm-2 m-3 btn-sm\",onClick:handleDelete},\"Delete\")),/*#__PURE__*/React.createElement(Table,{className:\"sm mt-3\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",{className:\"fs-sm\"},/*#__PURE__*/React.createElement(\"th\",null),/*#__PURE__*/React.createElement(\"th\",null,\"Holiday\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date\"),/*#__PURE__*/React.createElement(\"th\",null,\"Year\"))),/*#__PURE__*/React.createElement(\"tbody\",null,holidays.map(function(c,index){return/*#__PURE__*/React.createElement(\"tr\",{key:c.id,Style:\"cursor: pointer;\",onClick:function onClick(){return handleOnEdit(c);}},/*#__PURE__*/React.createElement(\"td\",null,index+1),/*#__PURE__*/React.createElement(\"td\",null,c.holiday),/*#__PURE__*/React.createElement(\"td\",null,moment(c.hdate).format('DD-MMMM-YYYY')),/*#__PURE__*/React.createElement(\"td\",null,c.year));}))));};export default HolidaySetup;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/holiday.js"],"names":["React","useState","useEffect","axios","Joi","moment","momentBusinessDays","baseUrl","auth","Swal","Row","Col","Table","Progress","Button","UncontrolledButtonDropdown","DropdownMenu","DropdownToggle","DropdownItem","Input","Label","Badge","CBadge","CCard","CCardBody","CCol","CDataTable","CRow","CButton","CModal","CModalFooter","CModalHeader","CModalBody","CCardHeader","CInputGroupAppend","CInputGroupPrepend","CDropdownItem","CForm","CDropdownToggle","CDropdown","CModalTitle","CFormGroup","CLabel","CInput","CSelect","CDropdownMenu","CInputGroup","HolidaySetup","holiday","hdate","year","setHoliday","holidays","setHolidays","Date","getFullYear","currentYear","setCurrentYear","editMode","setEditMode","render","setRender","getHolidays","yearInt","get","apiUrl","results","data","disableButton","setDisableButton","joiHolidaySchema","object","keys","string","required","label","date","number","validateEntry","result","validate","error","details","message","handleDateChange","e","currentTarget","value","handleOnEdit","p","console","log","id","toISOString","slice","handleSubmit","post","status","fire","handleUpdate","put","handleDelete","delete","map","c","index","format"],"mappings":"opBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,GAAP,KAAgB,aAAhB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,sBAA/B,CACA,MAAOC,CAAAA,OAAP,KAAoB,mBAApB,CACA,MAAOC,CAAAA,IAAP,KAAiB,uCAAjB,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CACA,OACEC,GADF,CAEEC,GAFF,CAGEC,KAHF,CAIEC,QAJF,CAKEC,MALF,CAMEC,0BANF,CAOEC,YAPF,CAQEC,cARF,CASEC,YATF,CAUEC,KAVF,CAWEC,KAXF,CAYEC,KAZF,KAaO,YAbP,CAcA,OACEC,MADF,CAEEC,KAFF,CAGEC,SACA;AAJF,CAKEC,IALF,CAMEC,UANF,CAOEC,IAPF,CAQEC,OARF,CASEC,MATF,CAUEC,YAVF,CAWEC,YAXF,CAYEC,UAZF,CAaEC,WAbF,CAcEC,iBAdF,CAeEC,kBAfF,CAgBEC,aAhBF,CAiBEC,KACA;AAlBF,CAmBEC,eACA;AApBF,CAqBEC,SArBF,CAsBEC,WACA;AACA;AAxBF,CAyBEC,UAzBF,CA0BEC,MACA;AA3BF,CA4BEC,MACA;AA7BF,CA8BEC,OA9BF,CA+BEC,aACA;AAhCF,CAiCEC,WACA;AAlCF,KAmCO,eAnCP,CAqCA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,eACK9C,QAAQ,CAAC,CACrC+C,OAAO,CAAE,EAD4B,CAErCC,KAAK,CAAE,EAF8B,CAGrCC,IAAI,CAAE,EAH+B,CAAD,CADb,wCAClBF,OADkB,eACTG,UADS,8BAMOlD,QAAQ,CAAC,EAAD,CANf,yCAMlBmD,QANkB,eAMRC,WANQ,8BAOapD,QAAQ,CAAC,GAAIqD,CAAAA,IAAJ,GAAWC,WAAX,EAAD,CAPrB,yCAOlBC,WAPkB,eAOLC,cAPK,8BAQOxD,QAAQ,CAAC,KAAD,CARf,yCAQlByD,QARkB,eAQRC,WARQ,8BASG1D,QAAQ,CAAC,KAAD,CATX,0CASlB2D,MATkB,gBASVC,SATU,gBAWzB3D,SAAS,CAAC,UAAM,SACC4D,CAAAA,WADD,2IACd,uJACQC,OADR,CACkB,GAAIT,CAAAA,IAAJ,EADlB,uBAEwBnD,CAAAA,KAAK,CAAC6D,GAAN,CACpBzD,OAAO,CAAC0D,MAAR,CAAiB,iBAAjB,CAAqCT,WADjB,CAFxB,QAEQU,OAFR,eAKEb,WAAW,CAACa,OAAO,CAACC,IAAT,CAAX,CALF,sDADc,8CAQdL,WAAW,GACZ,CATQ,CASN,CAACN,WAAD,CAAcI,MAAd,CATM,CAAT,CAXyB,gBAsBiB3D,QAAQ,CAAC,KAAD,CAtBzB,2CAsBlBmE,aAtBkB,gBAsBHC,gBAtBG,gBAwBzB,GAAMC,CAAAA,gBAAgB,CAAGlE,GAAG,CAACmE,MAAJ,GAAaC,IAAb,CAAkB,CACzCxB,OAAO,CAAE5C,GAAG,CAACqE,MAAJ,GAAaC,QAAb,GAAwBC,KAAxB,CAA8B,SAA9B,CADgC,CAEzC1B,KAAK,CAAE7C,GAAG,CAACwE,IAAJ,GAAWF,QAAX,GAAsBC,KAAtB,CAA4B,MAA5B,CAFkC,CAGzCzB,IAAI,CAAE9C,GAAG,CAACyE,MAAJ,GAAaH,QAAb,GAAwBC,KAAxB,CAA8B,cAA9B,CAHmC,CAAlB,CAAzB,CAMA,GAAMG,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1B,GAAMC,CAAAA,MAAM,CAAG3E,GAAG,CAAC4E,QAAJ,CAAa5B,QAAb,CAAuBkB,gBAAvB,CAAf,CACA,GAAIS,MAAM,CAACE,KAAX,CAAkB,CAChB,MAAOF,CAAAA,MAAM,CAACE,KAAP,CAAaC,OAAb,CAAqB,CAArB,EAAwBC,OAA/B,CACD,CAFD,IAEO,CACL,MAAO,KAAP,CACD,CACF,CAPD,CASA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,CAAD,CAAO,CAC9B,GAAMnC,CAAAA,IAAI,CAAG,GAAII,CAAAA,IAAJ,CAAS+B,CAAC,CAACC,aAAF,CAAgBC,KAAzB,CAAb,CACApC,UAAU,gCACLH,OADK,MAERC,KAAK,CAAEoC,CAAC,CAACC,aAAF,CAAgBC,KAFf,CAGRrC,IAAI,CAAEA,IAAI,CAACK,WAAL,EAHE,GAAV,CAKD,CAPD,CASA,GAAMiC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CAC1BC,OAAO,CAACC,GAAR,CAAYF,CAAZ,EACA9B,WAAW,CAAC,IAAD,CAAX,CACAR,UAAU,CAAC,CACTyC,EAAE,CAAEH,CAAC,CAACG,EADG,CAET5C,OAAO,CAAEyC,CAAC,CAACzC,OAFF,CAGTC,KAAK,CAAE,GAAIK,CAAAA,IAAJ,CAASmC,CAAC,CAACxC,KAAX,EAAkB4C,WAAlB,GAAgCC,KAAhC,CAAsC,CAAtC,CAAyC,EAAzC,CAHE,CAIT5C,IAAI,CAAEuC,CAAC,CAACvC,IAJC,CAAD,CAAV,CAMA;AACD,CAVD,CAYA,GAAM6C,CAAAA,YAAY,0FAAG,oJACnB;AACAjB,aAAa,GAFM,wCAIK3E,CAAAA,KAAK,CAAC6F,IAAN,CACpBzF,OAAO,CAAC0D,MAAR,CAAiB,gBADG,CAEpBjB,OAFoB,CAJL,QAIXkB,OAJW,gBASjB,GAAIA,OAAO,CAAC+B,MAAR,GAAmB,GAAvB,CAA4B,CAC1BxF,IAAI,CAACyF,IAAL,CAAU,SAAV,CAAqB,eAArB,CAAsC,SAAtC,EACArC,SAAS,CAAC,CAACD,MAAF,CAAT,CACD,CAHD,IAGO,CACLnD,IAAI,CAACyF,IAAL,CAAU,QAAV,CAAoB,0BAApB,CAAgD,OAAhD,EACD,CAdgB,mFAgBjBzF,IAAI,CAACyF,IAAL,CAAU,aAAM,2BAAhB,CAA6C,OAA7C,EAhBiB,QAkBnB/C,UAAU,CAAC,CAAEH,OAAO,CAAE,EAAX,CAAeC,KAAK,CAAE,EAAtB,CAAD,CAAV,CAlBmB,sEAAH,kBAAZ8C,CAAAA,YAAY,0CAAlB,CAqBA,GAAMI,CAAAA,YAAY,2FAAG,kBAAOd,CAAP,kIACnBK,OAAO,CAACC,GAAR,CAAY3C,OAAZ,EADmB,KAEfA,OAAO,CAACA,OAAR,GAAoB,EAFL,oEAIO7C,CAAAA,KAAK,CAACiG,GAAN,CACpB7F,OAAO,CAAC0D,MAAR,CAAiB,gBADG,CAEpBjB,OAFoB,CAJP,QAITkB,OAJS,qBAQXA,OAAO,CAAC+B,MAAR,GAAmB,GARR,6DASNxF,IAAI,CAACyF,IAAL,CACL,QADK,CAEL,mDAFK,CAGL,OAHK,CATM,UAebzF,IAAI,CAACyF,IAAL,CAAU,SAAV,CAAqB,8BAArB,CAAqD,SAArD,EAEA/C,UAAU,CAAC,CACTH,OAAO,CAAE,EADA,CAETC,KAAK,CAAE,EAFE,CAGTC,IAAI,CAAE,EAHG,CAAD,CAAV,CAKAW,SAAS,CAAC,CAACD,MAAF,CAAT,CACAD,WAAW,CAAC,KAAD,CAAX,CACAE,SAAS,CAAC,CAACD,MAAF,CAAT,CAxBa,6FA2BfnD,IAAI,CAACyF,IAAL,CAAU,UAAY,aAAIf,OAA1B,CAAmC,OAAnC,EA3Be,yEA8BV1E,IAAI,CAACyF,IAAL,CAAU,MAAV,CAAkB,qBAAlB,CAAyC,OAAzC,CA9BU,yEAAH,kBAAZC,CAAAA,YAAY,6CAAlB,CAkCA,GAAME,CAAAA,YAAY,2FAAG,yJACfrD,OAAO,CAACA,OAAR,GAAoB,EADL,oEAGO7C,CAAAA,KAAK,CAACmG,MAAN,CACpB/F,OAAO,CAAC0D,MAAR,CAAiB,iBAAjB,CAAqCjB,OAAO,CAAC4C,EADzB,CAHP,QAGT1B,OAHS,qBAMXA,OAAO,CAAC+B,MAAR,GAAmB,GANR,4DAONxF,IAAI,CAACyF,IAAL,CACL,QADK,CAEL,mDAFK,CAGL,OAHK,CAPM,SAabzF,IAAI,CAACyF,IAAL,CAAU,SAAV,CAAqB,8BAArB,CAAqD,SAArD,EACA/C,UAAU,CAAC,CACTH,OAAO,CAAE,EADA,CAETC,KAAK,CAAE,EAFE,CAGTC,IAAI,CAAE,EAHG,CAAD,CAAV,CAKAW,SAAS,CAAC,CAACD,MAAF,CAAT,CACAD,WAAW,CAAC,KAAD,CAAX,CACAE,SAAS,CAAC,CAACD,MAAF,CAAT,CArBa,6FAwBfnD,IAAI,CAACyF,IAAL,CAAU,UAAY,aAAIf,OAA1B,CAAmC,OAAnC,EAxBe,yEA2BV1E,IAAI,CAACyF,IAAL,CAAU,MAAV,CAAkB,kBAAlB,CAAsC,OAAtC,CA3BU,yEAAH,kBAAZG,CAAAA,YAAY,2CAAlB,CA+BA,mBACE,2BAAK,SAAS,CAAC,iBAAf,eACE,0BAAI,SAAS,CAAC,gBAAd,oBADF,cAEE,yBAAG,SAAS,CAAC,gBAAb,0EAFF,cAKE,oBAAC,WAAD,EAAa,SAAS,CAAC,MAAvB,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,YAAhB,CAA6B,SAAS,CAAC,UAAvC,SADF,cAIE,oBAAC,OAAD,EACE,SAAS,CAAC,2BADZ,CAEE,aAAW,SAFb,CAGE,KAAK,CAAE7C,WAHT,CAIE,QAAQ,CAAE,kBAAC6B,CAAD,QAAO5B,CAAAA,cAAc,CAAC4B,CAAC,CAACC,aAAF,CAAgBC,KAAjB,CAArB,EAJZ,eAME,8BAAQ,KAAK,CAAE,GAAIjC,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CANF,cASE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CATF,cAYE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CAZF,cAeE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CAfF,cAkBE,8BAAQ,YAAY,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,EAAtB,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,EADH,CAlBF,cAqBE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CArBF,cAwBE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CAxBF,cA2BE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CA3BF,cA8BE,8BAAQ,KAAK,CAAE,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAA1C,EACG,GAAID,CAAAA,IAAJ,GAAWC,WAAX,GAA2B,CAD9B,CA9BF,CAJF,CALF,cA4CE,oBAAC,WAAD,EAAa,SAAS,CAAC,MAAvB,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,SAAS,CAAC,UAApC,YADF,cAIE,oBAAC,MAAD,EACE,YAAY,CAAC,KADf,CAEE,IAAI,CAAC,SAFP,CAGE,IAAI,CAAC,MAHP,CAIE,SAAS,CAAC,uBAJZ,CAKE,KAAK,CAAEP,OAAO,CAACA,OALjB,CAME,QAAQ,CAAE,kBAACqC,CAAD,QACRlC,CAAAA,UAAU,gCACLH,OADK,MAERA,OAAO,CAAEqC,CAAC,CAACC,aAAF,CAAgBC,KAFjB,GADF,EANZ,EAJF,CA5CF,cA8DE,oBAAC,WAAD,EAAa,SAAS,CAAC,MAAvB,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,YAAhB,CAA6B,SAAS,CAAC,UAAvC,iBADF,cAIE,oBAAC,MAAD,EACE,IAAI,CAAC,OADP,CAEE,IAAI,CAAC,MAFP,CAGE,SAAS,CAAC,uBAHZ,CAIE,KAAK,CAAEvC,OAAO,CAACC,KAJjB,CAKE,QAAQ,CAAEmC,gBALZ,EAJF,CA9DF,cA0EE,2BAAK,SAAS,CAAC,4BAAf,EACG,CAAC1B,QAAD,cACC,oBAAC,OAAD,EACE,SAAS,CAAC,sCADZ,CAEE,OAAO,CAAEqC,YAFX,WADD,CAOG,IARN,CASGrC,QAAQ,cACP,oBAAC,OAAD,EACE,SAAS,CAAC,qBADZ,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAEyC,YAHX,WADO,CAQL,IAjBN,CAmBGzC,QAAQ,eACP,oBAAC,OAAD,EACE,SAAS,CAAC,oCADZ,CAEE,OAAO,CAAE2C,YAFX,WApBJ,CA1EF,cAsGE,oBAAC,KAAD,EAAO,SAAS,CAAC,SAAjB,eACE,8CACE,0BAAI,SAAS,CAAC,OAAd,eACE,8BADF,cAEE,wCAFF,cAGE,qCAHF,cAIE,qCAJF,CADF,CADF,cASE,iCACGjD,QAAQ,CAACmD,GAAT,CAAa,SAACC,CAAD,CAAIC,KAAJ,qBACZ,0BACE,GAAG,CAAED,CAAC,CAACZ,EADT,CAEE,KAAK,CAAC,kBAFR,CAGE,OAAO,CAAE,yBAAMJ,CAAAA,YAAY,CAACgB,CAAD,CAAlB,EAHX,eAKE,8BAAKC,KAAK,CAAG,CAAb,CALF,cAME,8BAAKD,CAAC,CAACxD,OAAP,CANF,cAOE,8BAAK3C,MAAM,CAACmG,CAAC,CAACvD,KAAH,CAAN,CAAgByD,MAAhB,CAAuB,cAAvB,CAAL,CAPF,cAQE,8BAAKF,CAAC,CAACtD,IAAP,CARF,CADY,EAAb,CADH,CATF,CAtGF,CADF,CAiID,CAnRD,CAqRA,cAAeH,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport Joi from 'joi-browser'\nimport moment from 'moment'\nimport momentBusinessDays from 'moment-business-days'\nimport baseUrl from '../../config.json'\nimport auth from '../../components/services/authService'\nimport Swal from 'sweetalert2'\nimport {\n  Row,\n  Col,\n  Table,\n  Progress,\n  Button,\n  UncontrolledButtonDropdown,\n  DropdownMenu,\n  DropdownToggle,\n  DropdownItem,\n  Input,\n  Label,\n  Badge,\n} from 'reactstrap'\nimport {\n  CBadge,\n  CCard,\n  CCardBody,\n  //CCardHeader,\n  CCol,\n  CDataTable,\n  CRow,\n  CButton,\n  CModal,\n  CModalFooter,\n  CModalHeader,\n  CModalBody,\n  CCardHeader,\n  CInputGroupAppend,\n  CInputGroupPrepend,\n  CDropdownItem,\n  CForm,\n  //CCardFooter,\n  CDropdownToggle,\n  //CInputRadio,\n  CDropdown,\n  CModalTitle,\n  //CFormText,\n  //CTextarea,\n  CFormGroup,\n  CLabel,\n  // CSwitch,\n  CInput,\n  //CInputFile,\n  CSelect,\n  CDropdownMenu,\n  //CCardFooter,\n  CInputGroup,\n  //CForm,\n} from '@coreui/react'\n\nconst HolidaySetup = () => {\n  const [holiday, setHoliday] = useState({\n    holiday: '',\n    hdate: '',\n    year: '',\n  })\n  const [holidays, setHolidays] = useState([])\n  const [currentYear, setCurrentYear] = useState(new Date().getFullYear())\n  const [editMode, setEditMode] = useState(false)\n  const [render, setRender] = useState(false)\n\n  useEffect(() => {\n    async function getHolidays() {\n      const yearInt = new Date()\n      const results = await axios.get(\n        baseUrl.apiUrl + '/setup/holiday/' + currentYear,\n      )\n      setHolidays(results.data)\n    }\n    getHolidays()\n  }, [currentYear, render])\n\n  const [disableButton, setDisableButton] = useState(false)\n\n  const joiHolidaySchema = Joi.object().keys({\n    holiday: Joi.string().required().label('Holiday'),\n    hdate: Joi.date().required().label('date'),\n    year: Joi.number().required().label('Holiday Year'),\n  })\n\n  const validateEntry = () => {\n    const result = Joi.validate(holidays, joiHolidaySchema)\n    if (result.error) {\n      return result.error.details[0].message\n    } else {\n      return null\n    }\n  }\n\n  const handleDateChange = (e) => {\n    const year = new Date(e.currentTarget.value)\n    setHoliday({\n      ...holiday,\n      hdate: e.currentTarget.value,\n      year: year.getFullYear(),\n    })\n  }\n\n  const handleOnEdit = (p) => {\n    console.log(p)\n    setEditMode(true)\n    setHoliday({\n      id: p.id,\n      holiday: p.holiday,\n      hdate: new Date(p.hdate).toISOString().slice(0, 10),\n      year: p.year,\n    })\n    //setDisabled(!disabled);\n  }\n\n  const handleSubmit = async () => {\n    // console.log(holiday)\n    validateEntry()\n    try {\n      const results = await axios.post(\n        baseUrl.apiUrl + '/setup/holiday',\n        holiday,\n      )\n\n      if (results.status === 200) {\n        Swal.fire('Success', 'Holiday Saved', 'success')\n        setRender(!render)\n      } else {\n        Swal.fire('OOPS !', 'Saving Holiday, failed !', 'error')\n      }\n    } catch (err) {\n      Swal.fire(err + ' Saving Holiday, failed !', 'error')\n    }\n    setHoliday({ holiday: '', hdate: '' })\n  }\n\n  const handleUpdate = async (e) => {\n    console.log(holiday)\n    if (holiday.holiday !== '') {\n      try {\n        const results = await axios.put(\n          baseUrl.apiUrl + '/setup/holiday',\n          holiday,\n        )\n        if (results.status !== 200) {\n          return Swal.fire(\n            'OOPS !',\n            'Submission Failed ! Check Entries and try again !',\n            'error',\n          )\n        } else {\n          Swal.fire('Success', 'Holiday Updated Successfully', 'success')\n\n          setHoliday({\n            holiday: '',\n            hdate: '',\n            year: '',\n          })\n          setRender(!render)\n          setEditMode(false)\n          setRender(!render)\n        }\n      } catch (err) {\n        Swal.fire('OOPS ! ' + err.message, 'error')\n      }\n    } else {\n      return Swal.fire('OOPS', 'Enter all Details !', 'error')\n    }\n  }\n\n  const handleDelete = async () => {\n    if (holiday.holiday !== '') {\n      try {\n        const results = await axios.delete(\n          baseUrl.apiUrl + '/setup/holiday/' + holiday.id,\n        )\n        if (results.status !== 200) {\n          return Swal.fire(\n            'OOPS !',\n            'Submission Failed ! Check Entries and try again !',\n            'error',\n          )\n        } else {\n          Swal.fire('Success', 'Holiday Deleted Successfully', 'success')\n          setHoliday({\n            holiday: '',\n            hdate: '',\n            year: '',\n          })\n          setRender(!render)\n          setEditMode(false)\n          setRender(!render)\n        }\n      } catch (err) {\n        Swal.fire('OOPS ! ' + err.message, 'error')\n      }\n    } else {\n      return Swal.fire('OOPS', 'Select Holiday !', 'error')\n    }\n  }\n\n  return (\n    <div className=\"container-fluid\">\n      <h3 className=\"centertext m-3\">Set up Holidays</h3>\n      <p className=\"centertext m-3\">\n        Set up public holidays here. NB: Holidays are to be setup every year.\n      </p>\n      <CInputGroup className=\"mt-3\">\n        <CLabel htmlFor=\"dailysales\" className=\"col-sm-2\">\n          Year\n        </CLabel>\n        <CSelect\n          className=\"form-select col-sm-8 mb-3\"\n          aria-label=\"Default\"\n          value={currentYear}\n          onChange={(e) => setCurrentYear(e.currentTarget.value)}\n        >\n          <option value={new Date().getFullYear() - 4}>\n            {new Date().getFullYear() - 4}\n          </option>\n          <option value={new Date().getFullYear() - 3}>\n            {new Date().getFullYear() - 3}\n          </option>\n          <option value={new Date().getFullYear() - 2}>\n            {new Date().getFullYear() - 2}\n          </option>\n          <option value={new Date().getFullYear() - 1}>\n            {new Date().getFullYear() - 1}\n          </option>\n          <option defaultValue={new Date().getFullYear()}>\n            {new Date().getFullYear()}\n          </option>\n          <option value={new Date().getFullYear() + 1}>\n            {new Date().getFullYear() + 1}\n          </option>\n          <option value={new Date().getFullYear() + 2}>\n            {new Date().getFullYear() + 2}\n          </option>\n          <option value={new Date().getFullYear() + 3}>\n            {new Date().getFullYear() + 3}\n          </option>\n          <option value={new Date().getFullYear() + 4}>\n            {new Date().getFullYear() + 4}\n          </option>\n        </CSelect>\n      </CInputGroup>\n      <CInputGroup className=\"mt-3\">\n        <CLabel htmlFor=\"holiday\" className=\"col-sm-2\">\n          Holiday\n        </CLabel>\n        <CInput\n          autoComplete=\"off\"\n          name=\"holiday\"\n          type=\"text\"\n          className=\"form-control col-sm-8\"\n          value={holiday.holiday}\n          onChange={(e) =>\n            setHoliday({\n              ...holiday,\n              holiday: e.currentTarget.value,\n            })\n          }\n        />\n      </CInputGroup>\n      <CInputGroup className=\"mt-3\">\n        <CLabel htmlFor=\"dailysales\" className=\"col-sm-2\">\n          Holiday Date\n        </CLabel>\n        <CInput\n          name=\"hdate\"\n          type=\"date\"\n          className=\"form-control col-sm-8\"\n          value={holiday.hdate}\n          onChange={handleDateChange}\n        />\n      </CInputGroup>\n      <div className=\"row justify-content-center\">\n        {!editMode ? (\n          <CButton\n            className=\"btn btn-primary col-sm-2 mt-3 btn-sm\"\n            onClick={handleSubmit}\n          >\n            Submit\n          </CButton>\n        ) : null}\n        {editMode ? (\n          <CButton\n            className=\"btn-sm m-3 col-sm-2\"\n            color=\"success\"\n            onClick={handleUpdate}\n          >\n            Update\n          </CButton>\n        ) : null}\n\n        {editMode && (\n          <CButton\n            className=\"btn btn-danger col-sm-2 m-3 btn-sm\"\n            onClick={handleDelete}\n          >\n            Delete\n          </CButton>\n        )}\n      </div>\n      <Table className=\"sm mt-3\">\n        <thead>\n          <tr className=\"fs-sm\">\n            <th></th>\n            <th>Holiday</th>\n            <th>Date</th>\n            <th>Year</th>\n          </tr>\n        </thead>\n        <tbody>\n          {holidays.map((c, index) => (\n            <tr\n              key={c.id}\n              Style=\"cursor: pointer;\"\n              onClick={() => handleOnEdit(c)}\n            >\n              <td>{index + 1}</td>\n              <td>{c.holiday}</td>\n              <td>{moment(c.hdate).format('DD-MMMM-YYYY')}</td>\n              <td>{c.year}</td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n    </div>\n  )\n}\n\nexport default HolidaySetup\n"]},"metadata":{},"sourceType":"module"}