{"ast":null,"code":"import _objectSpread from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Modal}from'react-bootstrap';import{Link,useNavigate,Navigate,useHistory}from'react-router-dom';import axios from'axios';import moment from'moment';import Joi from'joi-browser';import CurrencyFormat from'react-currency-format';import Swal from'sweetalert2';import auth from'../../components/services/authService';import{apiUrl}from'../../config.json';import{reportUrl}from'../../config.json';import BookProduct from'./bookProduct';import LoanPrincipal from'./loanPrincipalEntry';import Guarantors from'./guarantors';import GuarantorTwo from'./guarantorTwo';import BusinessDetails from'./businessDetails';import Directions from'./directions';import AdaboSelect from'react-select';import{Row,Col,Table,Progress,Button,UncontrolledButtonDropdown,DropdownMenu,DropdownToggle,DropdownItem,Input,Label,Badge}from'reactstrap';import{CBadge,CCard,CCardBody//CCardHeader,\n,CCol,CDataTable,CRow,CButton,CModal,CModalFooter,CModalHeader,CModalBody,CCardHeader,CInputGroupAppend,CInputGroupPrepend,CDropdownItem,CForm//CCardFooter,\n,CDropdownToggle//CInputRadio,\n,CDropdown,CDropdownDivider,CModalTitle//CFormText,\n//CTextarea,\n,CFormGroup,CLabel// CSwitch,\n,CInput//CInputFile,\n,CSelect,CDropdownMenu//CCardFooter,\n,CInputGroup//CForm,\n}from'@coreui/react';import{now}from'moment';var ViewToCorrectRepayment=function ViewToCorrectRepayment(){var _React$createElement,_React$createElement2;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),dailycollections=_useState2[0],setDailyCollections=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),render=_useState4[0],setRender=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),search=_useState6[0],setSearch=_useState6[1];var _useState7=useState(new Date()),_useState8=_slicedToArray(_useState7,2),dated=_useState8[0],setDated=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),show=_useState10[0],setShow=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),save=_useState12[0],setSave=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),edit=_useState14[0],setEdit=_useState14[1];var _useState15=useState(new Date().toISOString().slice(0,10)),_useState16=_slicedToArray(_useState15,2),dateOfCollection=_useState16[0],setDateOfCollection=_useState16[1];var _useState17=useState({id:'',dateOfCollection:'',customer:'',officer:'',amount:'',ModeOfPayment:'',status:'',loanId:''}),_useState18=_slicedToArray(_useState17,2),allData=_useState18[0],setAllData=_useState18[1];var _useState19=useState({id:0,amount:0}),_useState20=_slicedToArray(_useState19,2),ds=_useState20[0],setDs=_useState20[1];function formatDate(date){var newDate=new Date(date);var year=newDate.getFullYear().toString();var month=(newDate.getMonth()+101).toString().substring(1);var day=(newDate.getDate()+100).toString().substring(1);return year+'-'+month+'-'+day;}useEffect(function(){function getDailyCollections(){return _getDailyCollections.apply(this,arguments);}function _getDailyCollections(){_getDailyCollections=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(apiUrl+'/loan/dailycollections/correction/'+dateOfCollection);case 2:results=_context.sent;setDailyCollections(results.data);//if (results.data[0].img == null) return\n//setBuffer(results.data[0].img.data)\ncase 4:case\"end\":return _context.stop();}}},_callee);}));return _getDailyCollections.apply(this,arguments);}getDailyCollections();},[render,dateOfCollection]);var handleDateOfPaymentChange=function handleDateOfPaymentChange(e){setDateOfCollection(e.currentTarget.value);};var handleSearchChanged=function handleSearchChanged(e){setSearch(e.currentTarget.value);};/*useEffect(() => {\n    async function getRegistrationFees() {\n      const results = await axios.get(apiUrl + '/loan/registrationfee')\n      setRegistrationFees(results.data)\n    }\n    getRegistrationFees()\n  }, [registrationFees, render])\n*/var data={dailycollectionsFilter:dailycollections.filter(function(item){return item.Officer.toLowerCase().includes(search.toLowerCase())||item.Customer.toLowerCase().includes(search.toLowerCase());})};var dataTouse=search.length===0?dailycollections:data.dailycollectionsFilter;var formatter=new Intl.NumberFormat('en-US',{style:'currency',currency:'GHS'// These options are needed to round to whole numbers if that's what you want.\n//minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n//maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n});var openCustomerListAsReport=function openCustomerListAsReport(url){var windowFeatures='left=100,top=100,width=320,height=320';window.open(url,'customerlist','popup',windowFeatures);};var showModal=function showModal(e){setAllData({id:e.id,dateOfCollection:e.dateOfCollection,customer:e.Customer,officer:e.Officer,amount:e.Amount,modeOfPayment:e.ModeOfPayment,status:e.status,loanId:e.loanId});setDs({id:e.id,amount:e.Amount});setShow(!show);};var handleCorrection=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var results;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(ds);_context2.prev=1;_context2.next=4;return axios.post(apiUrl+'/loan/dailycollections/payment/correctdailycollection',{id:ds.id,amount:ds.amount});case 4:results=_context2.sent;if(!(results.statusText==='OK')){_context2.next=12;break;}Swal.fire('Success','Correction Made','success');setAllData({id:'',dateOfCollection:'',customer:'',officer:'',amount:'',ModeOfPayment:'',status:'',loanId:''});setDs({id:0,amount:0});setRender(!render);_context2.next=13;break;case 12:return _context2.abrupt(\"return\",Swal.fire('OOPS','Correction Unsuccessful','error'));case 13:_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",Swal.fire(_context2.t0.message+'[OOPS','Correction Unsuccessful]','error'));case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[1,15]]);}));return function handleCorrection(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CRow,null,/*#__PURE__*/React.createElement(CCol,{lg:12},/*#__PURE__*/React.createElement(CCard,null,/*#__PURE__*/React.createElement(\"h4\",{className:\"text-left mt-3\"},\"Daily Collections Update\"),/*#__PURE__*/React.createElement(CCardBody,null,/*#__PURE__*/React.createElement(\"div\",{class:\"mb-3 row mt-5 col-sm-12\"},/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"dateOfPayment\",className:\"form-label\"},\"Date Of Payment\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3\"},/*#__PURE__*/React.createElement(CInput,{type:\"date\",class:\"form-control\",id:\"dateOfPayment\",value:dateOfCollection,onChange:handleDateOfPaymentChange})),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"search\",className:\"form-label\"},\"Search\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3\"},/*#__PURE__*/React.createElement(CInput,{type:\"text\",class:\"form-control\",id:\"search\",value:search,onChange:handleSearchChanged}))),/*#__PURE__*/React.createElement(Table,{className:\"table-sm\"},/*#__PURE__*/React.createElement(\"caption\",null,\"Daily Collections\"),/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",{className:\"fs-sm\"},/*#__PURE__*/React.createElement(\"th\",null),/*#__PURE__*/React.createElement(\"th\",null,\"ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Customer\"),/*#__PURE__*/React.createElement(\"th\",null,\"Officer\"),/*#__PURE__*/React.createElement(\"th\",null,\"Amount\"),/*#__PURE__*/React.createElement(\"th\",null,\"Mode Of Payment\"),/*#__PURE__*/React.createElement(\"th\",null,\"Status\"),/*#__PURE__*/React.createElement(\"th\",null,\"Loan ID\"),/*#__PURE__*/React.createElement(\"th\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,dataTouse.map(function(c,index){return/*#__PURE__*/React.createElement(\"tr\",{key:c.id},/*#__PURE__*/React.createElement(\"td\",null,index+1),/*#__PURE__*/React.createElement(\"td\",null,c.id),/*#__PURE__*/React.createElement(\"td\",null,c.Customer),/*#__PURE__*/React.createElement(\"td\",null,c.Officer),/*#__PURE__*/React.createElement(\"td\",null,formatter.format(c.Amount)),/*#__PURE__*/React.createElement(\"td\",null,c.ModeOfPayment),/*#__PURE__*/React.createElement(\"td\",null,c.status),/*#__PURE__*/React.createElement(\"td\",null,c.loanId),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(CButton,{color:\"success btn-sm\",onClick:function onClick(){return showModal(c);}},\"Select\")));}))))))),/*#__PURE__*/React.createElement(Modal,{className:\"modalCustomer fade \",size:\"md\",show:show,\"data-backdrop\":\"static\",\"data-keyboard\":\"false\",closeButton:true,align:\"left\"},/*#__PURE__*/React.createElement(Modal.Body,{className:\"modal-body col-sm-12\"},/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"nameOfOfficer\",className:\"form-label\"},\"Name of Customer\"),/*#__PURE__*/React.createElement(CInput,{name:\"nameOfCustomer\",className:\"text-left\",type:\"text\",id:\"nameOfCustomer\",value:allData.customer,autoComplete:\"off\"}),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"Balance\",className:\"form-label\"},\"Officer\"),/*#__PURE__*/React.createElement(CInput,{name:\"Balance\",className:\"form-control  text-left\",type:\"text\",id:\"Balance\",value:allData.officer,autoComplete:\"off\"}),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"amountReceived\",className:\"form-label\"},\"Mode Of Payment\"),/*#__PURE__*/React.createElement(CInput,{autoComplete:\"off\",type:\"text\",name:\"amountReceived\",className:\"form-control  text-right\",id:\"amountReceived\",value:allData.modeOfPayment,onChange:null}),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"comment\",className:\"form-label\"},\"Status\"),/*#__PURE__*/React.createElement(CInput,(_React$createElement={autoComplete:\"off\",type:\"textArea\",name:\"comment\",className:\"form-control text-left\",id:\"comment\",value:allData.status},_defineProperty(_React$createElement,\"autoComplete\",\"off\"),_defineProperty(_React$createElement,\"onChange\",null),_React$createElement)),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"comment\",className:\"form-label\"},\"Loan ID\"),/*#__PURE__*/React.createElement(CInput,(_React$createElement2={autoComplete:\"off\",type:\"textArea\",name:\"comment\",className:\"form-control text-left\",id:\"comment\",value:allData.loanId},_defineProperty(_React$createElement2,\"autoComplete\",\"off\"),_defineProperty(_React$createElement2,\"onChange\",null),_React$createElement2)),/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"Balance\",className:\"form-label\"},\"Amount (GHC)\"),/*#__PURE__*/React.createElement(CInput,{name:\"Balance\",className:\"form-control  text-left\",type:\"text\",id:\"Balance\",value:ds.amount,onChange:function onChange(e){return setDs(_objectSpread(_objectSpread({},ds),{},{amount:e.currentTarget.value}));},autoComplete:\"off\"}))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(CButton,{onClick:handleCorrection,color:\"success\"},\"Submit\"),/*#__PURE__*/React.createElement(CButton,{onClick:function onClick(){return setShow(false);},color:\"danger\"},\"Close\"))));};export default ViewToCorrectRepayment;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/viewToCorrectRepayments.js"],"names":["React","useState","useEffect","Modal","Link","useNavigate","Navigate","useHistory","axios","moment","Joi","CurrencyFormat","Swal","auth","apiUrl","reportUrl","BookProduct","LoanPrincipal","Guarantors","GuarantorTwo","BusinessDetails","Directions","AdaboSelect","Row","Col","Table","Progress","Button","UncontrolledButtonDropdown","DropdownMenu","DropdownToggle","DropdownItem","Input","Label","Badge","CBadge","CCard","CCardBody","CCol","CDataTable","CRow","CButton","CModal","CModalFooter","CModalHeader","CModalBody","CCardHeader","CInputGroupAppend","CInputGroupPrepend","CDropdownItem","CForm","CDropdownToggle","CDropdown","CDropdownDivider","CModalTitle","CFormGroup","CLabel","CInput","CSelect","CDropdownMenu","CInputGroup","now","ViewToCorrectRepayment","dailycollections","setDailyCollections","render","setRender","search","setSearch","Date","dated","setDated","show","setShow","save","setSave","edit","setEdit","toISOString","slice","dateOfCollection","setDateOfCollection","id","customer","officer","amount","ModeOfPayment","status","loanId","allData","setAllData","ds","setDs","formatDate","date","newDate","year","getFullYear","toString","month","getMonth","substring","day","getDate","getDailyCollections","get","results","data","handleDateOfPaymentChange","e","currentTarget","value","handleSearchChanged","dailycollectionsFilter","filter","item","Officer","toLowerCase","includes","Customer","dataTouse","length","formatter","Intl","NumberFormat","style","currency","openCustomerListAsReport","url","windowFeatures","window","open","showModal","Amount","modeOfPayment","handleCorrection","console","log","post","statusText","fire","message","map","c","index","format"],"mappings":"4zBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,KAAT,KAAsB,iBAAtB,CACA,OAASC,IAAT,CAAeC,WAAf,CAA4BC,QAA5B,CAAsCC,UAAtC,KAAwD,kBAAxD,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,MAAOC,CAAAA,GAAP,KAAgB,aAAhB,CACA,MAAOC,CAAAA,cAAP,KAA2B,uBAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CACA,MAAOC,CAAAA,IAAP,KAAiB,uCAAjB,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,OAASC,SAAT,KAA0B,mBAA1B,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,aAAP,KAA0B,sBAA1B,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,cAAxB,CACA,OACEC,GADF,CAEEC,GAFF,CAGEC,KAHF,CAIEC,QAJF,CAKEC,MALF,CAMEC,0BANF,CAOEC,YAPF,CAQEC,cARF,CASEC,YATF,CAUEC,KAVF,CAWEC,KAXF,CAYEC,KAZF,KAaO,YAbP,CAcA,OACEC,MADF,CAEEC,KAFF,CAGEC,SACA;AAJF,CAKEC,IALF,CAMEC,UANF,CAOEC,IAPF,CAQEC,OARF,CASEC,MATF,CAUEC,YAVF,CAWEC,YAXF,CAYEC,UAZF,CAaEC,WAbF,CAcEC,iBAdF,CAeEC,kBAfF,CAgBEC,aAhBF,CAiBEC,KACA;AAlBF,CAmBEC,eACA;AApBF,CAqBEC,SArBF,CAsBEC,gBAtBF,CAuBEC,WACA;AACA;AAzBF,CA0BEC,UA1BF,CA2BEC,MACA;AA5BF,CA6BEC,MACA;AA9BF,CA+BEC,OA/BF,CAgCEC,aACA;AAjCF,CAkCEC,WACA;AAnCF,KAoCO,eApCP,CAqCA,OAASC,GAAT,KAAoB,QAApB,CAEA,GAAMC,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,EAAM,8DACa7D,QAAQ,CAAC,EAAD,CADrB,wCAC5B8D,gBAD4B,eACVC,mBADU,8BAEP/D,QAAQ,CAAC,KAAD,CAFD,yCAE5BgE,MAF4B,eAEpBC,SAFoB,8BAGPjE,QAAQ,CAAC,EAAD,CAHD,yCAG5BkE,MAH4B,eAGpBC,SAHoB,8BAITnE,QAAQ,CAAC,GAAIoE,CAAAA,IAAJ,EAAD,CAJC,yCAI5BC,KAJ4B,eAIrBC,QAJqB,8BAKXtE,QAAQ,CAAC,KAAD,CALG,0CAK5BuE,IAL4B,gBAKtBC,OALsB,gCAMXxE,QAAQ,CAAC,IAAD,CANG,2CAM5ByE,IAN4B,gBAMtBC,OANsB,gCAOX1E,QAAQ,CAAC,KAAD,CAPG,2CAO5B2E,IAP4B,gBAOtBC,OAPsB,gCAQa5E,QAAQ,CACtD,GAAIoE,CAAAA,IAAJ,GAAWS,WAAX,GAAyBC,KAAzB,CAA+B,CAA/B,CAAkC,EAAlC,CADsD,CARrB,2CAQ5BC,gBAR4B,gBAQVC,mBARU,gCAWLhF,QAAQ,CAAC,CACrCiF,EAAE,CAAE,EADiC,CAErCF,gBAAgB,CAAE,EAFmB,CAGrCG,QAAQ,CAAE,EAH2B,CAIrCC,OAAO,CAAE,EAJ4B,CAKrCC,MAAM,CAAE,EAL6B,CAMrCC,aAAa,CAAE,EANsB,CAOrCC,MAAM,CAAE,EAP6B,CAQrCC,MAAM,CAAE,EAR6B,CAAD,CAXH,2CAW5BC,OAX4B,gBAWnBC,UAXmB,gCAsBfzF,QAAQ,CAAC,CAC3BiF,EAAE,CAAE,CADuB,CAE3BG,MAAM,CAAE,CAFmB,CAAD,CAtBO,2CAsB5BM,EAtB4B,gBAsBxBC,KAtBwB,gBA2BnC,QAASC,CAAAA,UAAT,CAAoBC,IAApB,CAA0B,CACxB,GAAIC,CAAAA,OAAO,CAAG,GAAI1B,CAAAA,IAAJ,CAASyB,IAAT,CAAd,CACA,GAAIE,CAAAA,IAAI,CAAGD,OAAO,CAACE,WAAR,GAAsBC,QAAtB,EAAX,CACA,GAAIC,CAAAA,KAAK,CAAG,CAACJ,OAAO,CAACK,QAAR,GAAqB,GAAtB,EAA2BF,QAA3B,GAAsCG,SAAtC,CAAgD,CAAhD,CAAZ,CACA,GAAIC,CAAAA,GAAG,CAAG,CAACP,OAAO,CAACQ,OAAR,GAAoB,GAArB,EAA0BL,QAA1B,GAAqCG,SAArC,CAA+C,CAA/C,CAAV,CACA,MAAOL,CAAAA,IAAI,CAAG,GAAP,CAAaG,KAAb,CAAqB,GAArB,CAA2BG,GAAlC,CACD,CAEDpG,SAAS,CAAC,UAAM,SACCsG,CAAAA,mBADD,mKACd,qKACwBhG,CAAAA,KAAK,CAACiG,GAAN,CACpB3F,MAAM,CAAG,oCAAT,CAAgDkE,gBAD5B,CADxB,QACQ0B,OADR,eAIE1C,mBAAmB,CAAC0C,OAAO,CAACC,IAAT,CAAnB,CACA;AACA;AANF,sDADc,sDASdH,mBAAmB,GACpB,CAVQ,CAUN,CAACvC,MAAD,CAASe,gBAAT,CAVM,CAAT,CAYA,GAAM4B,CAAAA,yBAAyB,CAAG,QAA5BA,CAAAA,yBAA4B,CAACC,CAAD,CAAO,CACvC5B,mBAAmB,CAAC4B,CAAC,CAACC,aAAF,CAAgBC,KAAjB,CAAnB,CACD,CAFD,CAGA,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACH,CAAD,CAAO,CACjCzC,SAAS,CAACyC,CAAC,CAACC,aAAF,CAAgBC,KAAjB,CAAT,CACD,CAFD,CAIA;;;;;;;EAQA,GAAMJ,CAAAA,IAAI,CAAG,CACXM,sBAAsB,CAAElD,gBAAgB,CAACmD,MAAjB,CACtB,SAACC,IAAD,QACEA,CAAAA,IAAI,CAACC,OAAL,CAAaC,WAAb,GAA2BC,QAA3B,CAAoCnD,MAAM,CAACkD,WAAP,EAApC,GACAF,IAAI,CAACI,QAAL,CAAcF,WAAd,GAA4BC,QAA5B,CAAqCnD,MAAM,CAACkD,WAAP,EAArC,CAFF,EADsB,CADb,CAAb,CAQA,GAAMG,CAAAA,SAAS,CACbrD,MAAM,CAACsD,MAAP,GAAkB,CAAlB,CAAsB1D,gBAAtB,CAAyC4C,IAAI,CAACM,sBADhD,CAGA,GAAIS,CAAAA,SAAS,CAAG,GAAIC,CAAAA,IAAI,CAACC,YAAT,CAAsB,OAAtB,CAA+B,CAC7CC,KAAK,CAAE,UADsC,CAE7CC,QAAQ,CAAE,KAEV;AACA;AACA;AAN6C,CAA/B,CAAhB,CAQA,GAAMC,CAAAA,wBAAwB,CAAG,QAA3BA,CAAAA,wBAA2B,CAACC,GAAD,CAAS,CACxC,GAAMC,CAAAA,cAAc,CAAG,uCAAvB,CACAC,MAAM,CAACC,IAAP,CAAYH,GAAZ,CAAiB,cAAjB,CAAiC,OAAjC,CAA0CC,cAA1C,EACD,CAHD,CAKA,GAAMG,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACvB,CAAD,CAAO,CACvBnB,UAAU,CAAC,CACTR,EAAE,CAAE2B,CAAC,CAAC3B,EADG,CAETF,gBAAgB,CAAE6B,CAAC,CAAC7B,gBAFX,CAGTG,QAAQ,CAAE0B,CAAC,CAACU,QAHH,CAITnC,OAAO,CAAEyB,CAAC,CAACO,OAJF,CAKT/B,MAAM,CAAEwB,CAAC,CAACwB,MALD,CAMTC,aAAa,CAAEzB,CAAC,CAACvB,aANR,CAOTC,MAAM,CAAEsB,CAAC,CAACtB,MAPD,CAQTC,MAAM,CAAEqB,CAAC,CAACrB,MARD,CAAD,CAAV,CAUAI,KAAK,CAAC,CACJV,EAAE,CAAE2B,CAAC,CAAC3B,EADF,CAEJG,MAAM,CAAEwB,CAAC,CAACwB,MAFN,CAAD,CAAL,CAIA5D,OAAO,CAAC,CAACD,IAAF,CAAP,CACD,CAhBD,CAkBA,GAAM+D,CAAAA,gBAAgB,0FAAG,oJACvBC,OAAO,CAACC,GAAR,CAAY9C,EAAZ,EADuB,wCAGCnF,CAAAA,KAAK,CAACkI,IAAN,CACpB5H,MAAM,CAAG,uDADW,CAEpB,CACEoE,EAAE,CAAES,EAAE,CAACT,EADT,CAEEG,MAAM,CAAEM,EAAE,CAACN,MAFb,CAFoB,CAHD,QAGfqB,OAHe,qBAUjBA,OAAO,CAACiC,UAAR,GAAuB,IAVN,4BAWnB/H,IAAI,CAACgI,IAAL,CAAU,SAAV,CAAqB,iBAArB,CAAwC,SAAxC,EACAlD,UAAU,CAAC,CACTR,EAAE,CAAE,EADK,CAETF,gBAAgB,CAAE,EAFT,CAGTG,QAAQ,CAAE,EAHD,CAITC,OAAO,CAAE,EAJA,CAKTC,MAAM,CAAE,EALC,CAMTC,aAAa,CAAE,EANN,CAOTC,MAAM,CAAE,EAPC,CAQTC,MAAM,CAAE,EARC,CAAD,CAAV,CAUAI,KAAK,CAAC,CACJV,EAAE,CAAE,CADA,CAEJG,MAAM,CAAE,CAFJ,CAAD,CAAL,CAIAnB,SAAS,CAAC,CAACD,MAAF,CAAT,CA1BmB,iEA6BZrD,IAAI,CAACgI,IAAL,CAAU,MAAV,CAAkB,yBAAlB,CAA6C,OAA7C,CA7BY,gIAgCdhI,IAAI,CAACgI,IAAL,CACL,aAAGC,OAAH,CAAa,OADR,CAEL,0BAFK,CAGL,OAHK,CAhCc,yEAAH,kBAAhBN,CAAAA,gBAAgB,0CAAtB,CAuCA,mBACE,4CACE,oBAAC,IAAD,mBACE,oBAAC,IAAD,EAAM,EAAE,CAAE,EAAV,eACE,oBAAC,KAAD,mBACE,0BAAI,SAAS,CAAC,gBAAd,6BADF,cAEE,oBAAC,SAAD,mBACE,2BAAK,KAAK,CAAC,yBAAX,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,eAAhB,CAAgC,SAAS,CAAC,YAA1C,oBADF,cAIE,2BAAK,SAAS,CAAC,UAAf,eACE,oBAAC,MAAD,EACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAC,cAFR,CAGE,EAAE,CAAC,eAHL,CAIE,KAAK,CAAEvD,gBAJT,CAKE,QAAQ,CAAE4B,yBALZ,EADF,CAJF,cAcE,oBAAC,MAAD,EAAQ,OAAO,CAAC,QAAhB,CAAyB,SAAS,CAAC,YAAnC,WAdF,cAiBE,2BAAK,SAAS,CAAC,UAAf,eACE,oBAAC,MAAD,EACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAC,cAFR,CAGE,EAAE,CAAC,QAHL,CAIE,KAAK,CAAEzC,MAJT,CAKE,QAAQ,CAAE6C,mBALZ,EADF,CAjBF,CADF,cA6BE,oBAAC,KAAD,EAAO,SAAS,CAAC,UAAjB,eACE,uDADF,cAEE,8CACE,0BAAI,SAAS,CAAC,OAAd,eACE,8BADF,cAEE,mCAFF,cAIE,yCAJF,cAKE,wCALF,cAME,uCANF,cAOE,gDAPF,cAQE,uCARF,cASE,wCATF,cAUE,8BAVF,CADF,CAFF,cAgBE,iCACGQ,SAAS,CAACsB,GAAV,CAAc,SAACC,CAAD,CAAIC,KAAJ,qBACb,0BAAI,GAAG,CAAED,CAAC,CAAC7D,EAAX,eACE,8BAAK8D,KAAK,CAAG,CAAb,CADF,cAEE,8BAAKD,CAAC,CAAC7D,EAAP,CAFF,cAIE,8BAAK6D,CAAC,CAACxB,QAAP,CAJF,cAKE,8BAAKwB,CAAC,CAAC3B,OAAP,CALF,cAME,8BAAKM,SAAS,CAACuB,MAAV,CAAiBF,CAAC,CAACV,MAAnB,CAAL,CANF,cAOE,8BAAKU,CAAC,CAACzD,aAAP,CAPF,cAQE,8BAAKyD,CAAC,CAACxD,MAAP,CARF,cASE,8BAAKwD,CAAC,CAACvD,MAAP,CATF,cAUE,2CACE,oBAAC,OAAD,EACE,KAAK,CAAC,gBADR,CAEE,OAAO,CAAE,yBAAM4C,CAAAA,SAAS,CAACW,CAAD,CAAf,EAFX,WADF,CAVF,CADa,EAAd,CADH,CAhBF,CA7BF,CAFF,CADF,CADF,CADF,cA8EE,oBAAC,KAAD,EACE,SAAS,CAAC,qBADZ,CAEE,IAAI,CAAC,IAFP,CAGE,IAAI,CAAEvE,IAHR,CAIE,gBAAc,QAJhB,CAKE,gBAAc,OALhB,CAME,WAAW,KANb,CAOE,KAAK,CAAC,MAPR,eASE,oBAAC,KAAD,CAAO,IAAP,EAAY,SAAS,CAAC,sBAAtB,eACE,6CACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,eAAhB,CAAgC,SAAS,CAAC,YAA1C,qBADF,cAIE,oBAAC,MAAD,EACE,IAAI,CAAC,gBADP,CAEE,SAAS,CAAC,WAFZ,CAGE,IAAI,CAAC,MAHP,CAIE,EAAE,CAAC,gBAJL,CAKE,KAAK,CAAEiB,OAAO,CAACN,QALjB,CAME,YAAY,CAAC,KANf,EAJF,cAaE,oBAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,SAAS,CAAC,YAApC,YAbF,cAgBE,oBAAC,MAAD,EACE,IAAI,CAAC,SADP,CAEE,SAAS,CAAC,yBAFZ,CAGE,IAAI,CAAC,MAHP,CAIE,EAAE,CAAC,SAJL,CAKE,KAAK,CAAEM,OAAO,CAACL,OALjB,CAME,YAAY,CAAC,KANf,EAhBF,cAyBE,oBAAC,MAAD,EAAQ,OAAO,CAAC,gBAAhB,CAAiC,SAAS,CAAC,YAA3C,oBAzBF,cA4BE,oBAAC,MAAD,EACE,YAAY,CAAC,KADf,CAEE,IAAI,CAAC,MAFP,CAGE,IAAI,CAAC,gBAHP,CAIE,SAAS,CAAC,0BAJZ,CAKE,EAAE,CAAC,gBALL,CAME,KAAK,CAAEK,OAAO,CAAC6C,aANjB,CAOE,QAAQ,CAAE,IAPZ,EA5BF,cAsCE,oBAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,SAAS,CAAC,YAApC,WAtCF,cAyCE,oBAAC,MAAD,wBACE,YAAY,CAAC,KADf,CAEE,IAAI,CAAC,UAFP,CAGE,IAAI,CAAC,SAHP,CAIE,SAAS,CAAC,wBAJZ,CAKE,EAAE,CAAC,SALL,CAME,KAAK,CAAE7C,OAAO,CAACF,MANjB,sDAOe,KAPf,kDAQY,IARZ,wBAzCF,cAmDE,oBAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,SAAS,CAAC,YAApC,YAnDF,cAsDE,oBAAC,MAAD,yBACE,YAAY,CAAC,KADf,CAEE,IAAI,CAAC,UAFP,CAGE,IAAI,CAAC,SAHP,CAIE,SAAS,CAAC,wBAJZ,CAKE,EAAE,CAAC,SALL,CAME,KAAK,CAAEE,OAAO,CAACD,MANjB,uDAOe,KAPf,mDAQY,IARZ,yBAtDF,cAgEE,oBAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,SAAS,CAAC,YAApC,iBAhEF,cAmEE,oBAAC,MAAD,EACE,IAAI,CAAC,SADP,CAEE,SAAS,CAAC,yBAFZ,CAGE,IAAI,CAAC,MAHP,CAIE,EAAE,CAAC,SAJL,CAKE,KAAK,CAAEG,EAAE,CAACN,MALZ,CAME,QAAQ,CAAE,kBAACwB,CAAD,QAAOjB,CAAAA,KAAK,gCAAMD,EAAN,MAAUN,MAAM,CAAEwB,CAAC,CAACC,aAAF,CAAgBC,KAAlC,GAAZ,EANZ,CAOE,YAAY,CAAC,KAPf,EAnEF,CADF,CATF,cAwFE,oBAAC,KAAD,CAAO,MAAP,mBACE,oBAAC,OAAD,EAAS,OAAO,CAAEwB,gBAAlB,CAAoC,KAAK,CAAC,SAA1C,WADF,cAKE,oBAAC,OAAD,EAAS,OAAO,CAAE,yBAAM9D,CAAAA,OAAO,CAAC,KAAD,CAAb,EAAlB,CAAwC,KAAK,CAAC,QAA9C,UALF,CAxFF,CA9EF,CADF,CAmLD,CAlUD,CAoUA,cAAeX,CAAAA,sBAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Modal } from 'react-bootstrap'\nimport { Link, useNavigate, Navigate, useHistory } from 'react-router-dom'\nimport axios from 'axios'\nimport moment from 'moment'\nimport Joi from 'joi-browser'\nimport CurrencyFormat from 'react-currency-format'\nimport Swal from 'sweetalert2'\nimport auth from '../../components/services/authService'\nimport { apiUrl } from '../../config.json'\nimport { reportUrl } from '../../config.json'\nimport BookProduct from './bookProduct'\nimport LoanPrincipal from './loanPrincipalEntry'\nimport Guarantors from './guarantors'\nimport GuarantorTwo from './guarantorTwo'\nimport BusinessDetails from './businessDetails'\nimport Directions from './directions'\nimport AdaboSelect from 'react-select'\nimport {\n  Row,\n  Col,\n  Table,\n  Progress,\n  Button,\n  UncontrolledButtonDropdown,\n  DropdownMenu,\n  DropdownToggle,\n  DropdownItem,\n  Input,\n  Label,\n  Badge,\n} from 'reactstrap'\nimport {\n  CBadge,\n  CCard,\n  CCardBody,\n  //CCardHeader,\n  CCol,\n  CDataTable,\n  CRow,\n  CButton,\n  CModal,\n  CModalFooter,\n  CModalHeader,\n  CModalBody,\n  CCardHeader,\n  CInputGroupAppend,\n  CInputGroupPrepend,\n  CDropdownItem,\n  CForm,\n  //CCardFooter,\n  CDropdownToggle,\n  //CInputRadio,\n  CDropdown,\n  CDropdownDivider,\n  CModalTitle,\n  //CFormText,\n  //CTextarea,\n  CFormGroup,\n  CLabel,\n  // CSwitch,\n  CInput,\n  //CInputFile,\n  CSelect,\n  CDropdownMenu,\n  //CCardFooter,\n  CInputGroup,\n  //CForm,\n} from '@coreui/react'\nimport { now } from 'moment'\n\nconst ViewToCorrectRepayment = () => {\n  const [dailycollections, setDailyCollections] = useState([])\n  const [render, setRender] = useState(false)\n  const [search, setSearch] = useState('')\n  const [dated, setDated] = useState(new Date())\n  const [show, setShow] = useState(false)\n  const [save, setSave] = useState(true)\n  const [edit, setEdit] = useState(false)\n  const [dateOfCollection, setDateOfCollection] = useState(\n    new Date().toISOString().slice(0, 10),\n  )\n  const [allData, setAllData] = useState({\n    id: '',\n    dateOfCollection: '',\n    customer: '',\n    officer: '',\n    amount: '',\n    ModeOfPayment: '',\n    status: '',\n    loanId: '',\n  })\n\n  const [ds, setDs] = useState({\n    id: 0,\n    amount: 0,\n  })\n\n  function formatDate(date) {\n    let newDate = new Date(date)\n    var year = newDate.getFullYear().toString()\n    var month = (newDate.getMonth() + 101).toString().substring(1)\n    var day = (newDate.getDate() + 100).toString().substring(1)\n    return year + '-' + month + '-' + day\n  }\n\n  useEffect(() => {\n    async function getDailyCollections() {\n      const results = await axios.get(\n        apiUrl + '/loan/dailycollections/correction/' + dateOfCollection,\n      )\n      setDailyCollections(results.data)\n      //if (results.data[0].img == null) return\n      //setBuffer(results.data[0].img.data)\n    }\n    getDailyCollections()\n  }, [render, dateOfCollection])\n\n  const handleDateOfPaymentChange = (e) => {\n    setDateOfCollection(e.currentTarget.value)\n  }\n  const handleSearchChanged = (e) => {\n    setSearch(e.currentTarget.value)\n  }\n\n  /*useEffect(() => {\n    async function getRegistrationFees() {\n      const results = await axios.get(apiUrl + '/loan/registrationfee')\n      setRegistrationFees(results.data)\n    }\n    getRegistrationFees()\n  }, [registrationFees, render])\n*/\n  const data = {\n    dailycollectionsFilter: dailycollections.filter(\n      (item) =>\n        item.Officer.toLowerCase().includes(search.toLowerCase()) ||\n        item.Customer.toLowerCase().includes(search.toLowerCase()),\n    ),\n  }\n\n  const dataTouse =\n    search.length === 0 ? dailycollections : data.dailycollectionsFilter\n\n  let formatter = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'GHS',\n\n    // These options are needed to round to whole numbers if that's what you want.\n    //minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n    //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n  })\n  const openCustomerListAsReport = (url) => {\n    const windowFeatures = 'left=100,top=100,width=320,height=320'\n    window.open(url, 'customerlist', 'popup', windowFeatures)\n  }\n\n  const showModal = (e) => {\n    setAllData({\n      id: e.id,\n      dateOfCollection: e.dateOfCollection,\n      customer: e.Customer,\n      officer: e.Officer,\n      amount: e.Amount,\n      modeOfPayment: e.ModeOfPayment,\n      status: e.status,\n      loanId: e.loanId,\n    })\n    setDs({\n      id: e.id,\n      amount: e.Amount,\n    })\n    setShow(!show)\n  }\n\n  const handleCorrection = async () => {\n    console.log(ds)\n    try {\n      const results = await axios.post(\n        apiUrl + '/loan/dailycollections/payment/correctdailycollection',\n        {\n          id: ds.id,\n          amount: ds.amount,\n        },\n      )\n      if (results.statusText === 'OK') {\n        Swal.fire('Success', 'Correction Made', 'success')\n        setAllData({\n          id: '',\n          dateOfCollection: '',\n          customer: '',\n          officer: '',\n          amount: '',\n          ModeOfPayment: '',\n          status: '',\n          loanId: '',\n        })\n        setDs({\n          id: 0,\n          amount: 0,\n        })\n        setRender(!render)\n      } else {\n        //console.log(results)\n        return Swal.fire('OOPS', 'Correction Unsuccessful', 'error')\n      }\n    } catch (ex) {\n      return Swal.fire(\n        ex.message + '[OOPS',\n        'Correction Unsuccessful]',\n        'error',\n      )\n    }\n  }\n  return (\n    <div>\n      <CRow>\n        <CCol lg={12}>\n          <CCard>\n            <h4 className=\"text-left mt-3\">Daily Collections Update</h4>\n            <CCardBody>\n              <div class=\"mb-3 row mt-5 col-sm-12\">\n                <CLabel htmlFor=\"dateOfPayment\" className=\"form-label\">\n                  Date Of Payment\n                </CLabel>\n                <div className=\"col-sm-3\">\n                  <CInput\n                    type=\"date\"\n                    class=\"form-control\"\n                    id=\"dateOfPayment\"\n                    value={dateOfCollection}\n                    onChange={handleDateOfPaymentChange}\n                  />\n                </div>\n\n                <CLabel htmlFor=\"search\" className=\"form-label\">\n                  Search\n                </CLabel>\n                <div className=\"col-sm-3\">\n                  <CInput\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"search\"\n                    value={search}\n                    onChange={handleSearchChanged}\n                  />\n                </div>\n              </div>\n\n              <Table className=\"table-sm\">\n                <caption>Daily Collections</caption>\n                <thead>\n                  <tr className=\"fs-sm\">\n                    <th></th>\n                    <th>ID</th>\n                    {/* <th>Date Of Collection</th> */}\n                    <th>Customer</th>\n                    <th>Officer</th>\n                    <th>Amount</th>\n                    <th>Mode Of Payment</th>\n                    <th>Status</th>\n                    <th>Loan ID</th>\n                    <th></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {dataTouse.map((c, index) => (\n                    <tr key={c.id}>\n                      <td>{index + 1}</td>\n                      <td>{c.id}</td>\n                      {/* <td>{c.dateOfCollection}</td> */}\n                      <td>{c.Customer}</td>\n                      <td>{c.Officer}</td>\n                      <td>{formatter.format(c.Amount)}</td>\n                      <td>{c.ModeOfPayment}</td>\n                      <td>{c.status}</td>\n                      <td>{c.loanId}</td>\n                      <td>\n                        <CButton\n                          color=\"success btn-sm\"\n                          onClick={() => showModal(c)}\n                        >\n                          Select\n                        </CButton>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </Table>\n            </CCardBody>\n          </CCard>\n        </CCol>\n      </CRow>\n      <Modal\n        className=\"modalCustomer fade \"\n        size=\"md\"\n        show={show}\n        data-backdrop=\"static\"\n        data-keyboard=\"false\"\n        closeButton\n        align=\"left\"\n      >\n        <Modal.Body className=\"modal-body col-sm-12\">\n          <form>\n            <CLabel htmlFor=\"nameOfOfficer\" className=\"form-label\">\n              Name of Customer\n            </CLabel>\n            <CInput\n              name=\"nameOfCustomer\"\n              className=\"text-left\"\n              type=\"text\"\n              id=\"nameOfCustomer\"\n              value={allData.customer}\n              autoComplete=\"off\"\n            />\n\n            <CLabel htmlFor=\"Balance\" className=\"form-label\">\n              Officer\n            </CLabel>\n            <CInput\n              name=\"Balance\"\n              className=\"form-control  text-left\"\n              type=\"text\"\n              id=\"Balance\"\n              value={allData.officer}\n              autoComplete=\"off\"\n            />\n\n            <CLabel htmlFor=\"amountReceived\" className=\"form-label\">\n              Mode Of Payment\n            </CLabel>\n            <CInput\n              autoComplete=\"off\"\n              type=\"text\"\n              name=\"amountReceived\"\n              className=\"form-control  text-right\"\n              id=\"amountReceived\"\n              value={allData.modeOfPayment}\n              onChange={null}\n            />\n\n            <CLabel htmlFor=\"comment\" className=\"form-label\">\n              Status\n            </CLabel>\n            <CInput\n              autoComplete=\"off\"\n              type=\"textArea\"\n              name=\"comment\"\n              className=\"form-control text-left\"\n              id=\"comment\"\n              value={allData.status}\n              autoComplete=\"off\"\n              onChange={null}\n            />\n            <CLabel htmlFor=\"comment\" className=\"form-label\">\n              Loan ID\n            </CLabel>\n            <CInput\n              autoComplete=\"off\"\n              type=\"textArea\"\n              name=\"comment\"\n              className=\"form-control text-left\"\n              id=\"comment\"\n              value={allData.loanId}\n              autoComplete=\"off\"\n              onChange={null}\n            />\n            <CLabel htmlFor=\"Balance\" className=\"form-label\">\n              Amount (GHC)\n            </CLabel>\n            <CInput\n              name=\"Balance\"\n              className=\"form-control  text-left\"\n              type=\"text\"\n              id=\"Balance\"\n              value={ds.amount}\n              onChange={(e) => setDs({ ...ds, amount: e.currentTarget.value })}\n              autoComplete=\"off\"\n            />\n          </form>\n        </Modal.Body>\n        <Modal.Footer>\n          <CButton onClick={handleCorrection} color=\"success\">\n            Submit\n          </CButton>\n\n          <CButton onClick={() => setShow(false)} color=\"danger\">\n            Close\n          </CButton>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  )\n}\n\nexport default ViewToCorrectRepayment\n"]},"metadata":{},"sourceType":"module"}