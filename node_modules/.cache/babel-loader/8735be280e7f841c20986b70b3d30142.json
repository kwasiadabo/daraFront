{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,useNavigate,Navigate,useParams,useHistory}from'react-router-dom';import axios from'axios';import moment from'moment';import{Modal}from'react-bootstrap';import auth from'../../components/services/authService';import Joi from'joi-browser';import Swal from'sweetalert2';import{apiUrl}from'../../config.json';import'../../.././src/schedulecards.css';import{Row,Col,Table,Progress,Button,UncontrolledButtonDropdown,DropdownMenu,DropdownToggle,DropdownItem,Input,Badge//Modal,\n}from'reactstrap';import{CBadge,CCard,CCardBody//CCardHeader,\n,CCol,CDataTable,CRow,CButton,CModal,CModalFooter,CModalHeader,CModalBody,CCardHeader,CInputGroupAppend,CInputGroupPrepend,CDropdownItem,CForm//CCardFooter,\n,CDropdownToggle//CInputRadio,\n,CDropdown,CDropdownDivider,CModalTitle//CFormText,\n//CTextarea,\n,CFormGroup,CLabel// CSwitch,\n,CInput//CInputFile,\n,CSelect,CDropdownMenu//CCardFooter,\n,CInputGroup//CForm,\n}from'@coreui/react';import{LineChart,BarChart,Line,CartesianGrid,XAxis,YAxis,Tooltip,Bar,Cell,Label,Legend,ResponsiveContainer}from'recharts';import{GiSatelliteCommunication}from'react-icons/gi';var CashAccounting=function CashAccounting(){var _useState=useState(auth.getCurrentUser),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),expenses=_useState4[0],setExpenses=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),loans=_useState6[0],setLoans=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),vaultTransfer=_useState8[0],setVaultTransfer=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),registrations=_useState10[0],setRegistrations=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),processingFee=_useState12[0],setProcessingFee=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),collateral=_useState14[0],setCollateral=_useState14[1];var _useState15=useState(new Date().toISOString().slice(0,10)),_useState16=_slicedToArray(_useState15,2),tdate=_useState16[0],setTdate=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),render=_useState18[0],setRender=_useState18[1];var navigate=useHistory();useEffect(function(){function getLoanCollections(){return _getLoanCollections.apply(this,arguments);}function _getLoanCollections(){_getLoanCollections=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(apiUrl+'/cashaccounting/loans/'+tdate);case 2:results=_context.sent;setLoans(results.data[0].TotalAmount);case 4:case\"end\":return _context.stop();}}},_callee);}));return _getLoanCollections.apply(this,arguments);}getLoanCollections();},[tdate]);useEffect(function(){function getCollateralCollections(){return _getCollateralCollections.apply(this,arguments);}function _getCollateralCollections(){_getCollateralCollections=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var results;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(apiUrl+'/cashaccounting/collateral/'+tdate);case 2:results=_context2.sent;setCollateral(results.data[0].collateral);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _getCollateralCollections.apply(this,arguments);}getCollateralCollections();},[tdate]);useEffect(function(){function getRegistrationCollections(){return _getRegistrationCollections.apply(this,arguments);}function _getRegistrationCollections(){_getRegistrationCollections=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var results;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(apiUrl+'/cashaccounting/registration/'+tdate);case 2:results=_context3.sent;setRegistrations(results.data[0].registrations);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _getRegistrationCollections.apply(this,arguments);}getRegistrationCollections();},[tdate]);useEffect(function(){function getExpenses(){return _getExpenses.apply(this,arguments);}function _getExpenses(){_getExpenses=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var results;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.get(apiUrl+'/cashaccounting/expenses/'+tdate);case 2:results=_context4.sent;setExpenses(results.data[0].expenses);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return _getExpenses.apply(this,arguments);}getExpenses();},[tdate]);useEffect(function(){function getProcessingFee(){return _getProcessingFee.apply(this,arguments);}function _getProcessingFee(){_getProcessingFee=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var results;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.get(apiUrl+'/cashaccounting/processingFee/'+tdate);case 2:results=_context5.sent;setProcessingFee(results.data[0].processingFee);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return _getProcessingFee.apply(this,arguments);}getProcessingFee();},[tdate]);useEffect(function(){function checkVaultTransfer(){return _checkVaultTransfer.apply(this,arguments);}function _checkVaultTransfer(){_checkVaultTransfer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var results;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return axios.get(apiUrl+'/vault/checkendofday/'+tdate);case 2:results=_context6.sent;setVaultTransfer(results.data[0].id);//console.log(results.data[0].id)\ncase 4:case\"end\":return _context6.stop();}}},_callee6);}));return _checkVaultTransfer.apply(this,arguments);}checkVaultTransfer();//console.log(vaultTransfer)\n},[tdate]);var formatter=new Intl.NumberFormat('en-US',{style:'currency',currency:'GHS'// These options are needed to round to whole numbers if that's what you want.\n//minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n//maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n});var handleDateChange=function handleDateChange(e){setTdate(e.currentTarget.value);};var handleTranfer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!(cashAtHand<=0)){_context8.next=2;break;}return _context8.abrupt(\"return\",Swal.fire('Transactions Empty','No transaction records showing','info'));case 2:Swal.fire({title:'Do you want to transfer cash at hand to vault ?',showDenyButton:true,showCancelButton:true,confirmButtonText:'Transfer',denyButtonText:\"Don't Transfer\"}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(result){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!result.isConfirmed){_context7.next=7;break;}_context7.next=3;return axios.post(apiUrl+'/cashaccounting',{Cr:cashAtHand,narration:'Cash at hand from -'+tdate,tdate:tdate});case 3:Swal.fire('Transferred!','','success');setRender(!render);_context7.next=8;break;case 7:if(result.isDenied){Swal.fire('Cancelled','','info');}case 8:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x){return _ref2.apply(this,arguments);};}());case 3:case\"end\":return _context8.stop();}}},_callee8);}));return function handleTranfer(){return _ref.apply(this,arguments);};}();var cashAtHand=loans+registrations+collateral-expenses;return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 mt-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"centertext mb-3\"},\"Daily Summary\")),/*#__PURE__*/React.createElement(\"p\",{className:\"text-center\"},\"This page gives a summary account of all monies received during the day. Expenses are made from such receipts and the remainder tranferred to vault.\")),/*#__PURE__*/React.createElement(CInput,{type:\"date\",className:\"col-sm-12\",id:\"dateOnCheque\",value:tdate,onChange:function onChange(e){setTdate(e.currentTarget.value);console.log(e.currentTarget.value);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-6 mt-3 procFee_bg\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Processing Fees\"),\" :\",' ',formatter.format(processingFee)),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-5 d-flex justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3 loans_bg text-center\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Loan Repayments\"),\": \",formatter.format(loans)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3 collateral_bg text-center\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Cash Collateral\"),\":\",' ',formatter.format(collateral)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3 registration_bg\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Registrations\"),\":\",' ',formatter.format(registrations)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-3 expenses_bg\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Expenses\"),\" : \",formatter.format(expenses))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 mt-5 cashAtHand_bg justify-content-center d-flex\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},\"Cash At Hand\"),\" :\",' ',formatter.format(cashAtHand))),vaultTransfer==0&&/*#__PURE__*/React.createElement(CButton,{onClick:handleTranfer,className:\"col-sm-12 mt-5\",color:\"success\"},\"Complete End of Day\"));};export default CashAccounting;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/cashAccounting.jsx"],"names":["React","useState","useEffect","Link","useNavigate","Navigate","useParams","useHistory","axios","moment","Modal","auth","Joi","Swal","apiUrl","Row","Col","Table","Progress","Button","UncontrolledButtonDropdown","DropdownMenu","DropdownToggle","DropdownItem","Input","Badge","CBadge","CCard","CCardBody","CCol","CDataTable","CRow","CButton","CModal","CModalFooter","CModalHeader","CModalBody","CCardHeader","CInputGroupAppend","CInputGroupPrepend","CDropdownItem","CForm","CDropdownToggle","CDropdown","CDropdownDivider","CModalTitle","CFormGroup","CLabel","CInput","CSelect","CDropdownMenu","CInputGroup","LineChart","BarChart","Line","CartesianGrid","XAxis","YAxis","Tooltip","Bar","Cell","Label","Legend","ResponsiveContainer","GiSatelliteCommunication","CashAccounting","getCurrentUser","user","setUser","expenses","setExpenses","loans","setLoans","vaultTransfer","setVaultTransfer","registrations","setRegistrations","processingFee","setProcessingFee","collateral","setCollateral","Date","toISOString","slice","tdate","setTdate","render","setRender","navigate","getLoanCollections","get","results","data","TotalAmount","getCollateralCollections","getRegistrationCollections","getExpenses","getProcessingFee","checkVaultTransfer","id","formatter","Intl","NumberFormat","style","currency","handleDateChange","e","currentTarget","value","handleTranfer","cashAtHand","fire","title","showDenyButton","showCancelButton","confirmButtonText","denyButtonText","then","result","isConfirmed","post","Cr","narration","isDenied","console","log","format"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport {\n  Link,\n  useNavigate,\n  Navigate,\n  useParams,\n  useHistory,\n} from 'react-router-dom'\nimport axios from 'axios'\nimport moment from 'moment'\nimport { Modal } from 'react-bootstrap'\nimport auth from '../../components/services/authService'\nimport Joi from 'joi-browser'\nimport Swal from 'sweetalert2'\nimport { apiUrl } from '../../config.json'\nimport '../../.././src/schedulecards.css'\nimport {\n  Row,\n  Col,\n  Table,\n  Progress,\n  Button,\n  UncontrolledButtonDropdown,\n  DropdownMenu,\n  DropdownToggle,\n  DropdownItem,\n  Input,\n  Badge,\n  //Modal,\n} from 'reactstrap'\n\nimport {\n  CBadge,\n  CCard,\n  CCardBody,\n  //CCardHeader,\n  CCol,\n  CDataTable,\n  CRow,\n  CButton,\n  CModal,\n  CModalFooter,\n  CModalHeader,\n  CModalBody,\n  CCardHeader,\n  CInputGroupAppend,\n  CInputGroupPrepend,\n  CDropdownItem,\n  CForm,\n  //CCardFooter,\n  CDropdownToggle,\n  //CInputRadio,\n  CDropdown,\n  CDropdownDivider,\n  CModalTitle,\n  //CFormText,\n  //CTextarea,\n  CFormGroup,\n  CLabel,\n  // CSwitch,\n  CInput,\n  //CInputFile,\n  CSelect,\n  CDropdownMenu,\n  //CCardFooter,\n  CInputGroup,\n  //CForm,\n} from '@coreui/react'\n\nimport {\n  LineChart,\n  BarChart,\n  Line,\n  CartesianGrid,\n  XAxis,\n  YAxis,\n  Tooltip,\n  Bar,\n  Cell,\n  Label,\n  Legend,\n  ResponsiveContainer,\n} from 'recharts'\nimport { GiSatelliteCommunication } from 'react-icons/gi'\n\nconst CashAccounting = () => {\n  const [user, setUser] = useState(auth.getCurrentUser)\n  const [expenses, setExpenses] = useState(0)\n  const [loans, setLoans] = useState(0)\n  const [vaultTransfer, setVaultTransfer] = useState(0)\n  const [registrations, setRegistrations] = useState(0)\n  const [processingFee, setProcessingFee] = useState(0)\n  const [collateral, setCollateral] = useState(0)\n  const [tdate, setTdate] = useState(new Date().toISOString().slice(0, 10))\n  const [render, setRender] = useState(false)\n\n  let navigate = useHistory()\n\n  useEffect(() => {\n    async function getLoanCollections() {\n      const results = await axios.get(apiUrl + '/cashaccounting/loans/' + tdate)\n      setLoans(results.data[0].TotalAmount)\n    }\n    getLoanCollections()\n  }, [tdate])\n\n  useEffect(() => {\n    async function getCollateralCollections() {\n      const results = await axios.get(\n        apiUrl + '/cashaccounting/collateral/' + tdate,\n      )\n      setCollateral(results.data[0].collateral)\n    }\n    getCollateralCollections()\n  }, [tdate])\n\n  useEffect(() => {\n    async function getRegistrationCollections() {\n      const results = await axios.get(\n        apiUrl + '/cashaccounting/registration/' + tdate,\n      )\n      setRegistrations(results.data[0].registrations)\n    }\n    getRegistrationCollections()\n  }, [tdate])\n\n  useEffect(() => {\n    async function getExpenses() {\n      const results = await axios.get(\n        apiUrl + '/cashaccounting/expenses/' + tdate,\n      )\n      setExpenses(results.data[0].expenses)\n    }\n    getExpenses()\n  }, [tdate])\n\n  useEffect(() => {\n    async function getProcessingFee() {\n      const results = await axios.get(\n        apiUrl + '/cashaccounting/processingFee/' + tdate,\n      )\n      setProcessingFee(results.data[0].processingFee)\n    }\n    getProcessingFee()\n  }, [tdate])\n\n  useEffect(() => {\n    async function checkVaultTransfer() {\n      //console.log(tdate)\n      const results = await axios.get(apiUrl + '/vault/checkendofday/' + tdate)\n      setVaultTransfer(results.data[0].id)\n      //console.log(results.data[0].id)\n    }\n    checkVaultTransfer()\n    //console.log(vaultTransfer)\n  }, [tdate])\n\n  let formatter = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'GHS',\n\n    // These options are needed to round to whole numbers if that's what you want.\n    //minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n    //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n  })\n\n  const handleDateChange = (e) => {\n    setTdate(e.currentTarget.value)\n  }\n\n  const handleTranfer = async () => {\n    if (cashAtHand <= 0)\n      return Swal.fire(\n        'Transactions Empty',\n        'No transaction records showing',\n        'info',\n      )\n    Swal.fire({\n      title: 'Do you want to transfer cash at hand to vault ?',\n      showDenyButton: true,\n      showCancelButton: true,\n      confirmButtonText: 'Transfer',\n      denyButtonText: `Don't Transfer`,\n    }).then(async (result) => {\n      /* Read more about isConfirmed, isDenied below */\n      if (result.isConfirmed) {\n        await axios.post(apiUrl + '/cashaccounting', {\n          Cr: cashAtHand,\n          narration: 'Cash at hand from -' + tdate,\n          tdate,\n        })\n        Swal.fire('Transferred!', '', 'success')\n        setRender(!render)\n      } else if (result.isDenied) {\n        Swal.fire('Cancelled', '', 'info')\n      }\n    })\n  }\n  const cashAtHand = loans + registrations + collateral - expenses\n  return (\n    <div className=\"container\">\n      <div className=\"row\">\n        <div className=\"col-sm-12 mt-2\">\n          <div className=\"row justify-content-center\">\n            <h4 className=\"centertext mb-3\">Daily Summary</h4>\n          </div>\n\n          <p className=\"text-center\">\n            This page gives a summary account of all monies received during the\n            day. Expenses are made from such receipts and the remainder\n            tranferred to vault.\n          </p>\n        </div>\n        <CInput\n          type=\"date\"\n          className=\"col-sm-12\"\n          id=\"dateOnCheque\"\n          value={tdate}\n          onChange={(e) => {\n            setTdate(e.currentTarget.value)\n            console.log(e.currentTarget.value)\n          }}\n        />\n        <div className=\"col-sm-6 mt-3 procFee_bg\">\n          <span className=\"\">Processing Fees</span> :{' '}\n          {formatter.format(processingFee)}\n        </div>\n\n        <div className=\"row mt-5 d-flex justify-content-center\">\n          <div className=\"col-sm-3 loans_bg text-center\">\n            <span className=\"\">Loan Repayments</span>: {formatter.format(loans)}\n          </div>\n\n          <div className=\"col-sm-3 collateral_bg text-center\">\n            <span className=\"\">Cash Collateral</span>:{' '}\n            {formatter.format(collateral)}\n          </div>\n\n          <div className=\"col-sm-3 registration_bg\">\n            <span className=\"\">Registrations</span>:{' '}\n            {formatter.format(registrations)}\n          </div>\n\n          <div className=\"col-sm-3 expenses_bg\">\n            <span className=\"\">Expenses</span> : {formatter.format(expenses)}\n          </div>\n        </div>\n        <div className=\"col-sm-12 mt-5 cashAtHand_bg justify-content-center d-flex\">\n          <span className=\"\">Cash At Hand</span> :{' '}\n          {formatter.format(cashAtHand)}\n        </div>\n      </div>\n      {vaultTransfer == 0 && (\n        <CButton\n          onClick={handleTranfer}\n          className=\"col-sm-12 mt-5\"\n          color=\"success\"\n        >\n          Complete End of Day\n        </CButton>\n      )}\n    </div>\n  )\n}\n\nexport default CashAccounting\n"]},"metadata":{},"sourceType":"module"}