{"ast":null,"code":"import _objectSpread from \"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/bookProduct.jsx\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, Navigate } from 'react-router-dom';\nimport axios from 'axios';\nimport baseUrl from '../../config.json';\nimport auth from '../../components/services/authService';\nimport Swal from 'sweetalert2';\nimport moment from 'moment';\nimport { apiUrl } from '../../config.json';\nimport Joi from 'joi-browser';\nimport { Row, Col, Table, Progress, Button, UncontrolledButtonDropdown, DropdownMenu, DropdownToggle, DropdownItem, Input, Label, Badge } from 'reactstrap';\nimport { CBadge, CCard, CCardBody //CCardHeader,\n, CCol, CDataTable, CRow, CButton, CModal, CModalFooter, CModalHeader, CModalBody, CCardHeader, CInputGroupAppend, CInputGroupPrepend, CDropdownItem, CForm //CCardFooter,\n, CDropdownToggle //CInputRadio,\n, CDropdown, CModalTitle //CFormText,\n//CTextarea,\n, CFormGroup, CLabel // CSwitch,\n, CInput //CInputFile,\n, CSelect, CDropdownMenu //CCardFooter,\n, CInputGroup //CForm,\n} from '@coreui/react';\n\nvar BookProduct = function BookProduct(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      products = _useState2[0],\n      setProducts = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedProduct = _useState4[0],\n      setSelectedProduct = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      productShow = _useState6[0],\n      setProductShow = _useState6[1];\n\n  var _useState7 = useState({\n    disbursementId: 0,\n    customer: 0,\n    product: 0,\n    cashCollateral: 0,\n    interestRate: 0,\n    frequency: '',\n    duration: 0\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      productData = _useState8[0],\n      setProductData = _useState8[1];\n\n  useEffect(function () {\n    function getProducts() {\n      return _getProducts.apply(this, arguments);\n    }\n\n    function _getProducts() {\n      _getProducts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var results;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return axios.get(baseUrl.apiUrl + '/setup/product');\n\n              case 2:\n                results = _context.sent;\n                setProducts(results.data);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _getProducts.apply(this, arguments);\n    }\n\n    getProducts();\n  }, [products]);\n\n  var handleProductSelect = function handleProductSelect(e) {\n    //console.log(products)\n    setSelectedProduct(products.filter(function (p) {\n      return p.id == e.currentTarget.value;\n    }));\n    var productSelected = products.filter(function (p) {\n      return p.id == e.currentTarget.value;\n    }); //console.log(selectedProduct[0])\n\n    setProductData(_objectSpread(_objectSpread({}, productData), {}, {\n      product: e.currentTarget.value,\n      customer: props.customer,\n      disbursementId: props.disbursementId,\n      cashCollateral: props.cashCollateral,\n      interestRate: productSelected[0].interestRate,\n      frequency: productSelected[0].frequency,\n      duration: productSelected[0].duration\n    }));\n  };\n\n  var schemaMap = {\n    disbursementId: Joi.number().required().label('Cheque Details'),\n    customer: Joi.number().required().label('Disbursed By'),\n    product: Joi.number().required().label('Customer'),\n    cashCollateral: Joi.number().label('Cash Collateral'),\n    interestRate: Joi.number().label('Interest Rate'),\n    frequency: Joi.string().label('Frequency'),\n    duration: Joi.number().label('Duration')\n  };\n  var schema = Joi.object(schemaMap);\n\n  var validateForm = function validateForm() {\n    var result = Joi.validate(productData, schema);\n\n    if (result.error) {\n      return result.error.details[0].message;\n    } else {\n      return null;\n    }\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var validate, results;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(productData);\n              /* if (productData.interestRate < selectedProduct[0].interestRate)\n                return Swal.fire(\n                  'Interest Rate Voilation',\n                  'Below 20% Interest Rates are not acceptable',\n                  'error',\n                )*/\n\n              validate = validateForm();\n\n              if (!(validate !== null)) {\n                _context2.next = 4;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", Swal.fire('Validation', validate, 'error'));\n\n            case 4:\n              _context2.prev = 4;\n              _context2.next = 7;\n              return axios.post(apiUrl + '/loan/booking/product', productData);\n\n            case 7:\n              results = _context2.sent;\n\n              if (!(results.status !== 200)) {\n                _context2.next = 12;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", Swal.fire('OOPs !', 'Submission Failed ! Check Entries and try again !', 'error'));\n\n            case 12:\n              Swal.fire('Good job!', 'Loan Product Saved Successfully', 'success');\n              setProductData({\n                disbursementId: 0,\n                customer: 0,\n                product: 0,\n                interestRate: 0,\n                frequency: '',\n                duration: 0\n              });\n              setProductShow(!productShow);\n\n            case 15:\n              _context2.next = 20;\n              break;\n\n            case 17:\n              _context2.prev = 17;\n              _context2.t0 = _context2[\"catch\"](4);\n              Swal.fire('OOPS Product Booking Error! ', 'Loan Product Booking NOT Saved', 'error');\n\n            case 20:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[4, 17]]);\n    }));\n\n    return function handleSubmit() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 mt-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CLabel, {\n    htmlFor: \"product\",\n    className: \"col-sm-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }\n  }, \"Select Product *\"), /*#__PURE__*/React.createElement(CSelect, {\n    id: \"product\",\n    className: \"col-sm-8\",\n    \"aria-label\": \"Default select example\",\n    value: productData.product,\n    onChange: handleProductSelect,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    defaultValue: \"\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }\n  }, \"--Select Product--\"), products.map(function (p) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: p.id,\n      value: p.id,\n      id: p.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 13\n      }\n    }, p.product);\n  })), /*#__PURE__*/React.createElement(CLabel, {\n    htmlFor: \"InterestRate\",\n    className: \"col-sm-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, \"Interest Rate (%)\"), /*#__PURE__*/React.createElement(CInput, {\n    type: \"text\",\n    className: \"col-sm-4\",\n    id: \"InterestRate\",\n    value: productData.interestRate,\n    onChange: function onChange(e) {\n      return setProductData(_objectSpread(_objectSpread({}, productData), {}, {\n        interestRate: e.currentTarget.value\n      }));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CLabel, {\n    htmlFor: \"frequency\",\n    className: \"col-sm-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 9\n    }\n  }, \"Payment Frequency *\"), /*#__PURE__*/React.createElement(CSelect, {\n    id: \"freqency\",\n    className: \"col-sm-8\",\n    \"aria-label\": \"Default select example\",\n    value: productData.frequency,\n    onChange: function onChange(e) {\n      return setProductData(_objectSpread(_objectSpread({}, productData), {}, {\n        frequency: e.currentTarget.value\n      }));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"Daily\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 11\n    }\n  }, \"Daily\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"Weekly\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 11\n    }\n  }, \"Weekly\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"Monthly\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 11\n    }\n  }, \"Monthly\"), \"))}\"), /*#__PURE__*/React.createElement(CLabel, {\n    htmlFor: \"Duration\",\n    className: \"col-sm-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 9\n    }\n  }, \"Duration (\", productData.frequency === 'Daily' ? 'Days' : productData.frequency === 'Weekly' ? 'Weeks' : 'Months', \")\"), /*#__PURE__*/React.createElement(CInput, {\n    type: \"text\",\n    className: \"col-sm-4\",\n    id: \"Duration\",\n    value: productData.duration,\n    onChange: function onChange(e) {\n      return setProductData(_objectSpread(_objectSpread({}, productData), {}, {\n        duration: e.currentTarget.value\n      }));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"justify-content-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CButton, {\n    onClick: handleSubmit,\n    className: \"m-3 float-right\",\n    color: \"success\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }, \"Submit\")));\n};\n\nexport default BookProduct;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/bookProduct.jsx"],"names":["React","useState","useEffect","Link","useNavigate","Navigate","axios","baseUrl","auth","Swal","moment","apiUrl","Joi","Row","Col","Table","Progress","Button","UncontrolledButtonDropdown","DropdownMenu","DropdownToggle","DropdownItem","Input","Label","Badge","CBadge","CCard","CCardBody","CCol","CDataTable","CRow","CButton","CModal","CModalFooter","CModalHeader","CModalBody","CCardHeader","CInputGroupAppend","CInputGroupPrepend","CDropdownItem","CForm","CDropdownToggle","CDropdown","CModalTitle","CFormGroup","CLabel","CInput","CSelect","CDropdownMenu","CInputGroup","BookProduct","props","products","setProducts","selectedProduct","setSelectedProduct","productShow","setProductShow","disbursementId","customer","product","cashCollateral","interestRate","frequency","duration","productData","setProductData","getProducts","get","results","data","handleProductSelect","e","filter","p","id","currentTarget","value","productSelected","schemaMap","number","required","label","string","schema","object","validateForm","result","validate","error","details","message","handleSubmit","console","log","fire","post","status","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Link, useNavigate, Navigate } from 'react-router-dom'\nimport axios from 'axios'\nimport baseUrl from '../../config.json'\nimport auth from '../../components/services/authService'\nimport Swal from 'sweetalert2'\nimport moment from 'moment'\nimport { apiUrl } from '../../config.json'\nimport Joi from 'joi-browser'\nimport {\n  Row,\n  Col,\n  Table,\n  Progress,\n  Button,\n  UncontrolledButtonDropdown,\n  DropdownMenu,\n  DropdownToggle,\n  DropdownItem,\n  Input,\n  Label,\n  Badge,\n} from 'reactstrap'\nimport {\n  CBadge,\n  CCard,\n  CCardBody,\n  //CCardHeader,\n  CCol,\n  CDataTable,\n  CRow,\n  CButton,\n  CModal,\n  CModalFooter,\n  CModalHeader,\n  CModalBody,\n  CCardHeader,\n  CInputGroupAppend,\n  CInputGroupPrepend,\n  CDropdownItem,\n  CForm,\n  //CCardFooter,\n  CDropdownToggle,\n  //CInputRadio,\n  CDropdown,\n  CModalTitle,\n  //CFormText,\n  //CTextarea,\n  CFormGroup,\n  CLabel,\n  // CSwitch,\n  CInput,\n  //CInputFile,\n  CSelect,\n  CDropdownMenu,\n  //CCardFooter,\n  CInputGroup,\n  //CForm,\n} from '@coreui/react'\n\nconst BookProduct = (props) => {\n  const [products, setProducts] = useState([])\n  const [selectedProduct, setSelectedProduct] = useState([])\n  const [productShow, setProductShow] = useState(false)\n  const [productData, setProductData] = useState({\n    disbursementId: 0,\n    customer: 0,\n    product: 0,\n    cashCollateral: 0,\n    interestRate: 0,\n    frequency: '',\n    duration: 0,\n  })\n\n  useEffect(() => {\n    async function getProducts() {\n      const results = await axios.get(baseUrl.apiUrl + '/setup/product')\n      setProducts(results.data)\n    }\n    getProducts()\n  }, [products])\n\n  const handleProductSelect = (e) => {\n    //console.log(products)\n    setSelectedProduct(products.filter((p) => p.id == e.currentTarget.value))\n\n    const productSelected = products.filter(\n      (p) => p.id == e.currentTarget.value,\n    )\n    //console.log(selectedProduct[0])\n    setProductData({\n      ...productData,\n      product: e.currentTarget.value,\n      customer: props.customer,\n      disbursementId: props.disbursementId,\n      cashCollateral: props.cashCollateral,\n      interestRate: productSelected[0].interestRate,\n      frequency: productSelected[0].frequency,\n      duration: productSelected[0].duration,\n    })\n  }\n\n  const schemaMap = {\n    disbursementId: Joi.number().required().label('Cheque Details'),\n    customer: Joi.number().required().label('Disbursed By'),\n    product: Joi.number().required().label('Customer'),\n    cashCollateral: Joi.number().label('Cash Collateral'),\n    interestRate: Joi.number().label('Interest Rate'),\n    frequency: Joi.string().label('Frequency'),\n    duration: Joi.number().label('Duration'),\n  }\n  const schema = Joi.object(schemaMap)\n\n  const validateForm = () => {\n    const result = Joi.validate(productData, schema)\n    if (result.error) {\n      return result.error.details[0].message\n    } else {\n      return null\n    }\n  }\n\n  const handleSubmit = async () => {\n    console.log(productData)\n    /* if (productData.interestRate < selectedProduct[0].interestRate)\n      return Swal.fire(\n        'Interest Rate Voilation',\n        'Below 20% Interest Rates are not acceptable',\n        'error',\n      )*/\n    const validate = validateForm()\n    if (validate !== null) {\n      return Swal.fire('Validation', validate, 'error')\n    }\n    try {\n      const results = await axios.post(\n        apiUrl + '/loan/booking/product',\n        productData,\n      )\n      if (results.status !== 200) {\n        return Swal.fire(\n          'OOPs !',\n          'Submission Failed ! Check Entries and try again !',\n          'error',\n        )\n      } else {\n        Swal.fire('Good job!', 'Loan Product Saved Successfully', 'success')\n\n        setProductData({\n          disbursementId: 0,\n          customer: 0,\n          product: 0,\n          interestRate: 0,\n          frequency: '',\n          duration: 0,\n        })\n        setProductShow(!productShow)\n      }\n    } catch (err) {\n      Swal.fire(\n        'OOPS Product Booking Error! ',\n        'Loan Product Booking NOT Saved',\n        'error',\n      )\n    }\n  }\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"col-sm-12 mt-3\">\n        <CLabel htmlFor=\"product\" className=\"col-sm-3\">\n          Select Product *\n        </CLabel>\n\n        <CSelect\n          id=\"product\"\n          className=\"col-sm-8\"\n          aria-label=\"Default select example\"\n          value={productData.product}\n          onChange={handleProductSelect}\n        >\n          <option defaultValue=\"\">--Select Product--</option>\n          {products.map((p) => (\n            <option key={p.id} value={p.id} id={p.id}>\n              {p.product}\n            </option>\n          ))}\n        </CSelect>\n\n        <CLabel htmlFor=\"InterestRate\" className=\"col-sm-3\">\n          Interest Rate (%)\n        </CLabel>\n        <CInput\n          type=\"text\"\n          className=\"col-sm-4\"\n          id=\"InterestRate\"\n          value={productData.interestRate}\n          onChange={(e) =>\n            setProductData({\n              ...productData,\n              interestRate: e.currentTarget.value,\n            })\n          }\n        />\n\n        <CLabel htmlFor=\"frequency\" className=\"col-sm-3\">\n          Payment Frequency *\n        </CLabel>\n\n        <CSelect\n          id=\"freqency\"\n          className=\"col-sm-8\"\n          aria-label=\"Default select example\"\n          value={productData.frequency}\n          onChange={(e) =>\n            setProductData({\n              ...productData,\n              frequency: e.currentTarget.value,\n            })\n          }\n        >\n          <option value=\"Daily\">Daily</option>\n          <option value=\"Weekly\">Weekly</option>\n          <option value=\"Monthly\">Monthly</option>\n          ))}\n        </CSelect>\n\n        <CLabel htmlFor=\"Duration\" className=\"col-sm-4\">\n          Duration (\n          {productData.frequency === 'Daily'\n            ? 'Days'\n            : productData.frequency === 'Weekly'\n            ? 'Weeks'\n            : 'Months'}\n          )\n        </CLabel>\n        <CInput\n          type=\"text\"\n          className=\"col-sm-4\"\n          id=\"Duration\"\n          value={productData.duration}\n          onChange={(e) =>\n            setProductData({\n              ...productData,\n              duration: e.currentTarget.value,\n            })\n          }\n        />\n      </div>\n      <div className=\"justify-content-center\">\n        <CButton\n          onClick={handleSubmit}\n          className=\"m-3 float-right\"\n          color=\"success\"\n        >\n          Submit\n        </CButton>\n      </div>\n    </div>\n  )\n}\n\nexport default BookProduct\n"]},"metadata":{},"sourceType":"module"}