{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Modal}from'react-bootstrap';import{Link,useNavigate,Navigate,useHistory}from'react-router-dom';import axios from'axios';import moment from'moment';import Joi from'joi-browser';import CurrencyFormat from'react-currency-format';import Swal from'sweetalert2';import auth from'../../components/services/authService';import{apiUrl}from'../../config.json';import{reportUrl}from'../../config.json';import BookProduct from'./bookProduct';import LoanPrincipal from'./loanPrincipalEntry';import Guarantors from'./guarantors';import GuarantorTwo from'./guarantorTwo';import BusinessDetails from'./businessDetails';import Directions from'./directions';import AdaboSelect from'react-select';import{Row,Col,Table,Progress,Button,UncontrolledButtonDropdown,DropdownMenu,DropdownToggle,DropdownItem,Input,Label,Badge}from'reactstrap';import{CBadge,CCard,CCardBody//CCardHeader,\n,CCol,CDataTable,CRow,CButton,CModal,CModalFooter,CModalHeader,CModalBody,CCardHeader,CInputGroupAppend,CInputGroupPrepend,CDropdownItem,CForm//CCardFooter,\n,CDropdownToggle//CInputRadio,\n,CDropdown,CDropdownDivider,CModalTitle//CFormText,\n//CTextarea,\n,CFormGroup,CLabel// CSwitch,\n,CInput//CInputFile,\n,CSelect,CDropdownMenu//CCardFooter,\n,CInputGroup//CForm,\n}from'@coreui/react';import{now}from'moment';var PaymentHistory=function PaymentHistory(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),loanBookings=_useState2[0],setLoanBookings=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),render=_useState4[0],setRender=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),customerLoans=_useState6[0],setCustomerLoans=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),customer=_useState8[0],setCustomer=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),customers=_useState10[0],setCustomers=_useState10[1];/*useEffect(() => {\n    async function getCustomerLoans() {\n      const results = await axios.get(\n        apiUrl + '/loanreports/customer/' + customer,\n      )\n      setCustomerLoans(results.data)\n    }\n    getCustomerLoans()\n  }, [])\n  */useEffect(function(){function getCustomers(){return _getCustomers.apply(this,arguments);}function _getCustomers(){_getCustomers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(apiUrl+'/customer');case 2:results=_context.sent;setCustomers(results.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return _getCustomers.apply(this,arguments);}getCustomers();},[customers]);var openCustomerListAsReport=function openCustomerListAsReport(url){var windowFeatures='left=100,top=100,width=320,height=320';window.open(url,'customerlist','popup',windowFeatures);};var formatter=new Intl.NumberFormat('en-US',{style:'currency',currency:'GHS'});/*const totalAmt = loanBalances.reduce((a, i) => {\n    return a + i.Balance\n  }, 0)\n  */var customerName=customers.map(function(opt){return{label:opt.fullName+' - '+opt.accountNumber,value:opt.id};});var handleCustomerSelected=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(opt){var optValue,results;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:optValue=opt.value;setCustomer(optValue);_context2.next=4;return axios.get(apiUrl+'/loanreports/customer/'+optValue);case 4:results=_context2.sent;console.log(results.data);setCustomerLoans(results.data);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCustomerSelected(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{class:\"mb-3 row\"},/*#__PURE__*/React.createElement(CLabel,{htmlFor:\"nameOfCustomer\",className:\"col-sm-3 col-form-label\"},\"Select of Customer\"),/*#__PURE__*/React.createElement(\"div\",{class:\"col-sm-12\"},/*#__PURE__*/React.createElement(AdaboSelect,{className:\"form-control-xl mb-2 mt-2\",options:customerName,onChange:handleCustomerSelected}))),/*#__PURE__*/React.createElement(CRow,null,/*#__PURE__*/React.createElement(CCol,{lg:12},/*#__PURE__*/React.createElement(CCard,null,/*#__PURE__*/React.createElement(CCardHeader,{className:\"text-right\"}),/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center mt-3\"},\"Customer Loans\"),/*#__PURE__*/React.createElement(CCardBody,null,/*#__PURE__*/React.createElement(Table,{className:\"table-sm\"},/*#__PURE__*/React.createElement(\"caption\",null,\"Customer Loans\"),/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",{className:\"fs-sm\"},/*#__PURE__*/React.createElement(\"th\",null),/*#__PURE__*/React.createElement(\"th\",null,\"Account Number\"),/*#__PURE__*/React.createElement(\"th\",null,\"Customer\"),/*#__PURE__*/React.createElement(\"th\",null,\"Loan ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Product\"),/*#__PURE__*/React.createElement(\"th\",null,\"Principal\"),/*#__PURE__*/React.createElement(\"th\",null,\"Interest\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date Booked\"),/*#__PURE__*/React.createElement(\"th\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,customerLoans.map(function(c,index){return/*#__PURE__*/React.createElement(\"tr\",{key:c.id},/*#__PURE__*/React.createElement(\"td\",null,index+1),/*#__PURE__*/React.createElement(\"td\",null,c.accountNumber),/*#__PURE__*/React.createElement(\"td\",null,c.customer),/*#__PURE__*/React.createElement(\"td\",null,c.loanId),/*#__PURE__*/React.createElement(\"td\",null,c.product),/*#__PURE__*/React.createElement(\"td\",null,formatter.format(c.principal)),/*#__PURE__*/React.createElement(\"td\",null,formatter.format(c.interest)),/*#__PURE__*/React.createElement(\"td\",null,c.dateBooked),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(CButton,{className:\"btn-sm float-right\",onClick:function onClick(){return openCustomerListAsReport(reportUrl+'/paymentHistory.aspx?'+customer+'?'+c.id);}},\"View History\")));}))))))));};export default PaymentHistory;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/paymentHistory.jsx"],"names":["React","useState","useEffect","Modal","Link","useNavigate","Navigate","useHistory","axios","moment","Joi","CurrencyFormat","Swal","auth","apiUrl","reportUrl","BookProduct","LoanPrincipal","Guarantors","GuarantorTwo","BusinessDetails","Directions","AdaboSelect","Row","Col","Table","Progress","Button","UncontrolledButtonDropdown","DropdownMenu","DropdownToggle","DropdownItem","Input","Label","Badge","CBadge","CCard","CCardBody","CCol","CDataTable","CRow","CButton","CModal","CModalFooter","CModalHeader","CModalBody","CCardHeader","CInputGroupAppend","CInputGroupPrepend","CDropdownItem","CForm","CDropdownToggle","CDropdown","CDropdownDivider","CModalTitle","CFormGroup","CLabel","CInput","CSelect","CDropdownMenu","CInputGroup","now","PaymentHistory","loanBookings","setLoanBookings","render","setRender","customerLoans","setCustomerLoans","customer","setCustomer","customers","setCustomers","getCustomers","get","results","data","openCustomerListAsReport","url","windowFeatures","window","open","formatter","Intl","NumberFormat","style","currency","customerName","map","opt","label","fullName","accountNumber","value","id","handleCustomerSelected","optValue","console","log","c","index","loanId","product","format","principal","interest","dateBooked"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Modal } from 'react-bootstrap'\nimport { Link, useNavigate, Navigate, useHistory } from 'react-router-dom'\nimport axios from 'axios'\nimport moment from 'moment'\nimport Joi from 'joi-browser'\nimport CurrencyFormat from 'react-currency-format'\nimport Swal from 'sweetalert2'\nimport auth from '../../components/services/authService'\nimport { apiUrl } from '../../config.json'\nimport { reportUrl } from '../../config.json'\nimport BookProduct from './bookProduct'\nimport LoanPrincipal from './loanPrincipalEntry'\nimport Guarantors from './guarantors'\nimport GuarantorTwo from './guarantorTwo'\nimport BusinessDetails from './businessDetails'\nimport Directions from './directions'\nimport AdaboSelect from 'react-select'\nimport {\n  Row,\n  Col,\n  Table,\n  Progress,\n  Button,\n  UncontrolledButtonDropdown,\n  DropdownMenu,\n  DropdownToggle,\n  DropdownItem,\n  Input,\n  Label,\n  Badge,\n} from 'reactstrap'\nimport {\n  CBadge,\n  CCard,\n  CCardBody,\n  //CCardHeader,\n  CCol,\n  CDataTable,\n  CRow,\n  CButton,\n  CModal,\n  CModalFooter,\n  CModalHeader,\n  CModalBody,\n  CCardHeader,\n  CInputGroupAppend,\n  CInputGroupPrepend,\n  CDropdownItem,\n  CForm,\n  //CCardFooter,\n  CDropdownToggle,\n  //CInputRadio,\n  CDropdown,\n  CDropdownDivider,\n  CModalTitle,\n  //CFormText,\n  //CTextarea,\n  CFormGroup,\n  CLabel,\n  // CSwitch,\n  CInput,\n  //CInputFile,\n  CSelect,\n  CDropdownMenu,\n  //CCardFooter,\n  CInputGroup,\n  //CForm,\n} from '@coreui/react'\nimport { now } from 'moment'\n\nconst PaymentHistory = () => {\n  const [loanBookings, setLoanBookings] = useState([])\n  const [render, setRender] = useState(false)\n  const [customerLoans, setCustomerLoans] = useState([])\n  const [customer, setCustomer] = useState(0)\n  const [customers, setCustomers] = useState([])\n\n  /*useEffect(() => {\n    async function getCustomerLoans() {\n      const results = await axios.get(\n        apiUrl + '/loanreports/customer/' + customer,\n      )\n      setCustomerLoans(results.data)\n    }\n    getCustomerLoans()\n  }, [])\n  */\n\n  useEffect(() => {\n    async function getCustomers() {\n      const results = await axios.get(apiUrl + '/customer')\n      setCustomers(results.data)\n    }\n    getCustomers()\n  }, [customers])\n\n  const openCustomerListAsReport = (url) => {\n    const windowFeatures = 'left=100,top=100,width=320,height=320'\n    window.open(url, 'customerlist', 'popup', windowFeatures)\n  }\n\n  let formatter = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'GHS',\n  })\n\n  /*const totalAmt = loanBalances.reduce((a, i) => {\n    return a + i.Balance\n  }, 0)\n  */\n\n  const customerName = customers.map((opt) => ({\n    label: opt.fullName + ' - ' + opt.accountNumber,\n    value: opt.id,\n  }))\n\n  const handleCustomerSelected = async (opt) => {\n    const optValue = opt.value\n    setCustomer(optValue)\n    const results = await axios.get(\n      apiUrl + '/loanreports/customer/' + optValue,\n    )\n    console.log(results.data)\n    setCustomerLoans(results.data)\n  }\n  return (\n    <div>\n      <div class=\"mb-3 row\">\n        <CLabel htmlFor=\"nameOfCustomer\" className=\"col-sm-3 col-form-label\">\n          Select of Customer\n        </CLabel>\n        <div class=\"col-sm-12\">\n          <AdaboSelect\n            className=\"form-control-xl mb-2 mt-2\"\n            options={customerName}\n            onChange={handleCustomerSelected}\n          />\n        </div>\n      </div>\n      <CRow>\n        <CCol lg={12}>\n          <CCard>\n            <CCardHeader className=\"text-right\"></CCardHeader>\n            <h4 className=\"text-center mt-3\">Customer Loans</h4>\n            <CCardBody>\n              <Table className=\"table-sm\">\n                <caption>Customer Loans</caption>\n                <thead>\n                  <tr className=\"fs-sm\">\n                    <th></th>\n                    <th>Account Number</th>\n                    <th>Customer</th>\n                    <th>Loan ID</th>\n                    <th>Product</th>\n                    <th>Principal</th>\n                    <th>Interest</th>\n                    <th>Date Booked</th>\n                    <th></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {customerLoans.map((c, index) => (\n                    <tr key={c.id}>\n                      <td>{index + 1}</td>\n                      <td>{c.accountNumber}</td>\n                      <td>{c.customer}</td>\n                      <td>{c.loanId}</td>\n                      <td>{c.product}</td>\n                      <td>{formatter.format(c.principal)}</td>\n                      <td>{formatter.format(c.interest)}</td>\n                      <td>{c.dateBooked}</td>\n                      <td>\n                        <CButton\n                          className=\"btn-sm float-right\"\n                          onClick={() =>\n                            openCustomerListAsReport(\n                              reportUrl +\n                                '/paymentHistory.aspx?' +\n                                customer +\n                                '?' +\n                                c.id,\n                            )\n                          }\n                        >\n                          View History\n                        </CButton>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </Table>\n            </CCardBody>\n          </CCard>\n        </CCol>\n      </CRow>\n    </div>\n  )\n}\n\nexport default PaymentHistory\n"]},"metadata":{},"sourceType":"module"}