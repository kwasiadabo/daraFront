{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/Dara/daraPlusApp/daraFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import axios from'axios';import auth from'../../components/services/authService';import Swal from'sweetalert2';import{apiUrl}from'../../config.json';import{reportUrl}from'../../config.json';import{Table//Modal,\n}from'reactstrap';import{//CCardHeader,\nCInput,CButton}from'@coreui/react';import{LineChart,BarChart,Line,CartesianGrid,XAxis,YAxis,Tooltip,Bar,Cell,Label,Legend,ResponsiveContainer}from'recharts';import{GiSatelliteCommunication}from'react-icons/gi';var BookedLoans=function BookedLoans(){var _useState=useState(auth.getCurrentUser),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),expenses=_useState4[0],setExpenses=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),bookedLoans=_useState6[0],setBookedLoans=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),render=_useState8[0],setRender=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),search=_useState10[0],setSearch=_useState10[1];var _useState11=useState(new Date().toISOString().slice(0,10)),_useState12=_slicedToArray(_useState11,2),startDate=_useState12[0],setStartDate=_useState12[1];var _useState13=useState(new Date().toISOString().slice(0,10)),_useState14=_slicedToArray(_useState13,2),endDate=_useState14[0],setEndDate=_useState14[1];var navigate=useHistory();useEffect(function(){function getBookedLoans(){return _getBookedLoans.apply(this,arguments);}function _getBookedLoans(){_getBookedLoans=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(apiUrl+'/loan/booking/booked');case 2:results=_context.sent;setBookedLoans(results.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return _getBookedLoans.apply(this,arguments);}getBookedLoans();},[render]);var handleSearch=function handleSearch(event){setSearch(event.target.value);};var data={allBooked:bookedLoans.filter(function(item){return item.fullName.toLowerCase().includes(search.toLowerCase());})};var dataTouse=search.length===0?bookedLoans:data.allBooked;var formatter=new Intl.NumberFormat('en-US',{style:'currency',currency:'GHS'// These options are needed to round to whole numbers if that's what you want.\n//minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n//maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n});var totalAmt=expenses.reduce(function(a,i){return a+i.amount;},0);var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(c){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(c.id);Swal.fire({title:'Do you want to REMOVE this BOOKING ?',showDenyButton:true,showCancelButton:true,confirmButtonText:'Remove',denyButtonText:\"Don't\"}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!result.isConfirmed){_context2.next=7;break;}_context2.next=3;return axios.delete(apiUrl+'/loan/booking/'+c.id);case 3:Swal.fire('Removed!','','success');setRender(!render);_context2.next=8;break;case 7:if(result.isDenied){Swal.fire('Cancelled','','info');}case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"centertext mb-3\"},\"VIEW BOOKED LOANS\")),/*#__PURE__*/React.createElement(\"p\",{className:\"text-center\"},\"NB: Booked Loans can removed from here. Only booked loans without payments or payments not yet started will appear in the list.\\u201D\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12\"},/*#__PURE__*/React.createElement(CInput,{type:\"text\",name:\"searchCustomer\",className:\"float-center col-sm-6 mb-3 mt-3\",id:\"searchCustomer\",value:null,onChange:handleSearch,placeholder:\"Search booked loans\"}),/*#__PURE__*/React.createElement(Table,{className:\"table-sm col-sm-12\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"\"},/*#__PURE__*/React.createElement(\"tr\",{className:\"fs-sm\"},/*#__PURE__*/React.createElement(\"th\",null),/*#__PURE__*/React.createElement(\"th\",null,\"Date\"),/*#__PURE__*/React.createElement(\"th\",null,\"Customer\"),/*#__PURE__*/React.createElement(\"th\",null,\"Account Number\"),/*#__PURE__*/React.createElement(\"th\",null,\"Loan ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Principal\"),/*#__PURE__*/React.createElement(\"th\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,dataTouse.map(function(c,index){return/*#__PURE__*/React.createElement(\"tr\",{key:c.id},/*#__PURE__*/React.createElement(\"td\",null,index+1),/*#__PURE__*/React.createElement(\"td\",null,c.dateBooked),/*#__PURE__*/React.createElement(\"td\",null,c.fullName),/*#__PURE__*/React.createElement(\"td\",null,c.accountNumber),/*#__PURE__*/React.createElement(\"td\",null,c.loanId),/*#__PURE__*/React.createElement(\"td\",null,formatter.format(c.principal)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(CButton,{onClick:function onClick(){return handleDelete(c);},className:\"btn-sm\",color:\"danger\"},\"Remove\")));}))))));};export default BookedLoans;","map":{"version":3,"sources":["/Users/mac/Documents/Dara/daraPlusApp/daraFront/src/views/pages/removeLoanBooking.js"],"names":["React","useState","useEffect","useHistory","axios","auth","Swal","apiUrl","reportUrl","Table","CInput","CButton","LineChart","BarChart","Line","CartesianGrid","XAxis","YAxis","Tooltip","Bar","Cell","Label","Legend","ResponsiveContainer","GiSatelliteCommunication","BookedLoans","getCurrentUser","user","setUser","expenses","setExpenses","bookedLoans","setBookedLoans","render","setRender","search","setSearch","Date","toISOString","slice","startDate","setStartDate","endDate","setEndDate","navigate","getBookedLoans","get","results","data","handleSearch","event","target","value","allBooked","filter","item","fullName","toLowerCase","includes","dataTouse","length","formatter","Intl","NumberFormat","style","currency","totalAmt","reduce","a","i","amount","handleDelete","c","console","log","id","fire","title","showDenyButton","showCancelButton","confirmButtonText","denyButtonText","then","result","isConfirmed","delete","isDenied","map","index","dateBooked","accountNumber","loanId","format","principal"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport axios from 'axios'\nimport auth from '../../components/services/authService'\nimport Swal from 'sweetalert2'\nimport { apiUrl } from '../../config.json'\nimport { reportUrl } from '../../config.json'\n\nimport {\n  Table,\n  //Modal,\n} from 'reactstrap'\n\nimport {\n  //CCardHeader,\n  CInput,\n  CButton,\n} from '@coreui/react'\n\nimport {\n  LineChart,\n  BarChart,\n  Line,\n  CartesianGrid,\n  XAxis,\n  YAxis,\n  Tooltip,\n  Bar,\n  Cell,\n  Label,\n  Legend,\n  ResponsiveContainer,\n} from 'recharts'\nimport { GiSatelliteCommunication } from 'react-icons/gi'\n\nconst BookedLoans = () => {\n  const [user, setUser] = useState(auth.getCurrentUser)\n  const [expenses, setExpenses] = useState([])\n  const [bookedLoans, setBookedLoans] = useState([])\n  const [render, setRender] = useState(false)\n  const [search, setSearch] = useState('')\n\n  const [startDate, setStartDate] = useState(\n    new Date().toISOString().slice(0, 10),\n  )\n  const [endDate, setEndDate] = useState(new Date().toISOString().slice(0, 10))\n  let navigate = useHistory()\n\n  useEffect(() => {\n    async function getBookedLoans() {\n      const results = await axios.get(apiUrl + '/loan/booking/booked')\n      setBookedLoans(results.data)\n    }\n    getBookedLoans()\n  }, [render])\n\n  const handleSearch = (event) => {\n    setSearch(event.target.value)\n  }\n\n  const data = {\n    allBooked: bookedLoans.filter((item) =>\n      item.fullName.toLowerCase().includes(search.toLowerCase()),\n    ),\n  }\n\n  const dataTouse = search.length === 0 ? bookedLoans : data.allBooked\n\n  let formatter = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'GHS',\n\n    // These options are needed to round to whole numbers if that's what you want.\n    //minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n    //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n  })\n\n  const totalAmt = expenses.reduce((a, i) => {\n    return a + i.amount\n  }, 0)\n\n  const handleDelete = async (c) => {\n    console.log(c.id)\n    Swal.fire({\n      title: 'Do you want to REMOVE this BOOKING ?',\n      showDenyButton: true,\n      showCancelButton: true,\n      confirmButtonText: 'Remove',\n      denyButtonText: `Don't`,\n    }).then(async (result) => {\n      /* Read more about isConfirmed, isDenied below */\n      if (result.isConfirmed) {\n        await axios.delete(apiUrl + '/loan/booking/' + c.id)\n        Swal.fire('Removed!', '', 'success')\n        setRender(!render)\n      } else if (result.isDenied) {\n        Swal.fire('Cancelled', '', 'info')\n      }\n    })\n  }\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-sm-12\">\n          <div className=\"row justify-content-center\">\n            <h4 className=\"centertext mb-3\">VIEW BOOKED LOANS</h4>\n          </div>\n\n          <p className=\"text-center\">\n            NB: Booked Loans can removed from here. Only booked loans without\n            payments or payments not yet started will appear in the list.‚Äù\n          </p>\n        </div>\n\n        <div className=\"col-sm-12\">\n          <CInput\n            type=\"text\"\n            name=\"searchCustomer\"\n            className=\"float-center col-sm-6 mb-3 mt-3\"\n            id=\"searchCustomer\"\n            value={null}\n            onChange={handleSearch}\n            placeholder=\"Search booked loans\"\n          />\n\n          <Table className=\"table-sm col-sm-12\">\n            <thead className=\"\">\n              <tr className=\"fs-sm\">\n                <th></th>\n                <th>Date</th>\n                <th>Customer</th>\n                <th>Account Number</th>\n                <th>Loan ID</th>\n                <th>Principal</th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              {dataTouse.map((c, index) => (\n                <tr key={c.id}>\n                  <td>{index + 1}</td>\n                  <td>{c.dateBooked}</td>\n                  <td>{c.fullName}</td>\n                  <td>{c.accountNumber}</td>\n                  <td>{c.loanId}</td>\n                  <td>{formatter.format(c.principal)}</td>\n                  <td>\n                    {\n                      <CButton\n                        onClick={() => handleDelete(c)}\n                        className=\"btn-sm\"\n                        color=\"danger\"\n                      >\n                        Remove\n                      </CButton>\n                    }\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default BookedLoans\n"]},"metadata":{},"sourceType":"module"}